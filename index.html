<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YOUGO CARS â€” ×©×•×§ ×”×¨×›×‘×™× ×”×“×™×’×™×˜×œ×™</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700;800;900&family=Noto+Kufi+Arabic:wght@400;700;900&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
:root {
  --red: #c8102e;
  --red-dark: #a50d25;
  --red-glow: rgba(200,16,46,0.2);
  --gold: #d4af37;
  --gold-light: rgba(212,175,55,0.15);
  --bg: #06060a;
  --bg2: #0c0c14;
  --bg3: #11111a;
  --card: #0f0f18;
  --card-hover: #14141f;
  --border: rgba(255,255,255,0.07);
  --border-red: rgba(200,16,46,0.35);
  --text: #eeeef5;
  --text2: rgba(238,238,245,0.5);
  --text3: rgba(238,238,245,0.28);
  --radius: 18px;
  --font: 'Heebo', 'Noto Kufi Arabic', sans-serif;
  --shadow-red: 0 0 40px rgba(200,16,46,0.12);
  --shadow-card: 0 8px 32px rgba(0,0,0,0.5);
}

* { margin:0; padding:0; box-sizing:border-box; }
html { scroll-behavior: smooth; }

body {
  font-family: var(--font);
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}

/* â”€â”€ SCROLLBAR â”€â”€ */
::-webkit-scrollbar { width: 5px; }
::-webkit-scrollbar-track { background: var(--bg); }
::-webkit-scrollbar-thumb { background: var(--red); border-radius: 3px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NAV
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
nav {
  position: fixed; top:0; left:0; right:0; z-index: 200;
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 28px; height: 66px;
  background: rgba(6,6,10,0.88);
  backdrop-filter: blur(24px) saturate(1.5);
  border-bottom: 1px solid var(--border);
}

.nav-logo {
  display: flex; align-items: center; gap: 11px;
  text-decoration: none;
}
.nav-logo-icon {
  width: 38px; height: 38px; border-radius: 12px;
  background: linear-gradient(135deg, var(--red), #e8223f);
  display: flex; align-items: center; justify-content: center;
  font-size: 19px;
  box-shadow: 0 4px 16px rgba(200,16,46,0.4);
}
.nav-logo-text { font-size: 18px; font-weight: 900; letter-spacing: -0.3px; }
.nav-logo-text span { color: var(--red); }

.nav-center { display: flex; gap: 4px; }
.nav-link {
  padding: 6px 14px; border-radius: 10px;
  font-size: 13px; font-weight: 700; color: var(--text2);
  cursor: pointer; background: none; border: none;
  font-family: var(--font); transition: all 0.2s;
}
.nav-link:hover { color: white; background: rgba(255,255,255,0.06); }

.nav-actions { display: flex; gap: 8px; align-items: center; }

.lang-btn {
  background: var(--bg3); border: 1px solid var(--border);
  color: var(--text2); padding: 7px 13px; border-radius: 10px;
  font-size: 13px; cursor: pointer; font-family: var(--font);
  transition: all 0.2s; font-weight: 600;
}
.lang-btn:hover { border-color: var(--border-red); color: white; }

.btn {
  display: inline-flex; align-items: center; gap: 6px;
  padding: 9px 20px; border-radius: 11px;
  font-family: var(--font); font-weight: 800; font-size: 14px;
  cursor: pointer; border: none; transition: all 0.2s;
  text-decoration: none; white-space: nowrap;
}
.btn-red {
  background: linear-gradient(135deg, var(--red), #e0162f);
  color: white;
  box-shadow: 0 4px 20px rgba(200,16,46,0.35);
}
.btn-red:hover {
  background: linear-gradient(135deg, #d91130, var(--red));
  transform: translateY(-1px);
  box-shadow: 0 6px 24px rgba(200,16,46,0.45);
}
.btn-ghost {
  background: rgba(255,255,255,0.06); color: var(--text2);
  border: 1px solid var(--border);
}
.btn-ghost:hover { background: rgba(255,255,255,0.1); color: white; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ADMIN BAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.admin-bar {
  background: linear-gradient(90deg, rgba(200,16,46,0.08), transparent);
  border-bottom: 1px solid var(--border-red);
  padding: 10px 28px; display: flex; gap: 10px;
  align-items: center; margin-top: 66px;
}
.admin-bar-title { font-weight: 900; color: var(--red); font-size: 14px; }
.admin-actions { display: flex; gap: 8px; margin-right: auto; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HERO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hero {
  padding: 130px 28px 70px;
  text-align: center;
  position: relative; overflow: hidden;
  background: var(--bg);
}

.hero-bg {
  position: absolute; inset: 0; z-index: 0;
  background:
    radial-gradient(ellipse 70% 55% at 50% 0%, rgba(200,16,46,0.16) 0%, transparent 65%),
    radial-gradient(ellipse 40% 30% at 20% 50%, rgba(200,16,46,0.05) 0%, transparent 60%),
    radial-gradient(ellipse 40% 30% at 80% 50%, rgba(200,16,46,0.05) 0%, transparent 60%);
}

.hero-grid {
  position: absolute; inset: 0; z-index: 0;
  background-image:
    linear-gradient(rgba(255,255,255,0.025) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,0.025) 1px, transparent 1px);
  background-size: 50px 50px;
  mask-image: radial-gradient(ellipse 85% 75% at 50% 20%, black 30%, transparent 80%);
}

.hero-content { position: relative; z-index: 1; }

.hero-badge {
  display: inline-flex; align-items: center; gap: 8px;
  padding: 7px 18px; border-radius: 100px;
  background: rgba(200,16,46,0.1); border: 1px solid var(--border-red);
  font-size: 11px; font-weight: 800; color: rgba(255,255,255,0.65);
  margin-bottom: 28px; text-transform: uppercase; letter-spacing: 0.12em;
  animation: fadeInDown 0.7s ease;
}
.hero-badge .dot {
  width: 7px; height: 7px; border-radius: 50%;
  background: var(--red);
  animation: pulse 2s infinite;
  box-shadow: 0 0 8px var(--red);
}

@keyframes pulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:0.5;transform:scale(0.85)} }
@keyframes fadeInDown { from { opacity:0; transform:translateY(-16px); } to { opacity:1; transform:translateY(0); } }
@keyframes fadeInUp { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }

.hero h1 {
  font-size: clamp(2.4rem, 7vw, 5rem);
  font-weight: 900; line-height: 1.08;
  margin-bottom: 18px;
  letter-spacing: -1px;
  animation: fadeInUp 0.7s 0.1s ease both;
}
.hero h1 .red { color: var(--red); position: relative; }
.hero h1 .red::after {
  content: '';
  position: absolute; bottom: -4px; left: 0; right: 0; height: 3px;
  background: linear-gradient(90deg, var(--red), transparent);
  border-radius: 2px;
}

.hero-sub {
  font-size: 16px; color: var(--text2); max-width: 480px;
  margin: 0 auto 38px; line-height: 1.75;
  animation: fadeInUp 0.7s 0.2s ease both;
}

.hero-btns {
  display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;
  animation: fadeInUp 0.7s 0.3s ease both;
}

.hero-stats {
  display: flex; justify-content: center; gap: 0;
  margin-top: 52px; flex-wrap: wrap;
  background: var(--bg2); border: 1px solid var(--border);
  border-radius: 20px; max-width: 520px; margin-inline: auto;
  overflow: hidden;
  animation: fadeInUp 0.7s 0.4s ease both;
}
.hero-stat {
  flex: 1; padding: 20px 16px; text-align: center;
  position: relative;
}
.hero-stat:not(:last-child)::after {
  content: '';
  position: absolute; right: 0; top: 20%; bottom: 20%;
  width: 1px; background: var(--border);
}
.hero-stat-val { font-size: 26px; font-weight: 900; }
.hero-stat-val .accent { color: var(--red); }
.hero-stat-label { font-size: 11px; color: var(--text3); margin-top: 3px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.08em; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SEARCH / FILTERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.search-section {
  padding: 0 28px 52px;
  background: var(--bg);
  position: relative; z-index: 10;
}

.search-box {
  max-width: 960px; margin: 0 auto;
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: 22px; padding: 22px 24px;
  box-shadow: 0 24px 64px rgba(0,0,0,0.45);
}

.search-row {
  display: flex; gap: 10px; margin-bottom: 14px; flex-wrap: wrap;
}

.search-input {
  flex: 1; min-width: 220px;
  background: var(--bg3); border: 1px solid var(--border);
  color: white; padding: 13px 18px; border-radius: 13px;
  font-family: var(--font); font-size: 14px;
  outline: none; transition: all 0.2s;
}
.search-input:focus {
  border-color: var(--red);
  box-shadow: 0 0 0 3px rgba(200,16,46,0.1);
}
.search-input::placeholder { color: var(--text3); }

.filter-row { display: flex; gap: 8px; flex-wrap: wrap; }

.filter-select {
  background: var(--bg3); border: 1px solid var(--border);
  color: var(--text2); padding: 10px 14px; border-radius: 11px;
  font-family: var(--font); font-size: 13px;
  cursor: pointer; outline: none; flex: 1; min-width: 130px;
  transition: border-color 0.2s;
}
.filter-select:focus { border-color: var(--red); }
option { background: #111; }

.search-btn {
  background: linear-gradient(135deg, var(--red), #e0162f);
  color: white; border: none;
  padding: 13px 30px; border-radius: 13px; font-weight: 800;
  font-family: var(--font); font-size: 15px; cursor: pointer;
  transition: all 0.2s; white-space: nowrap;
  box-shadow: 0 4px 16px rgba(200,16,46,0.3);
}
.search-btn:hover { transform: translateY(-1px); box-shadow: 0 6px 20px rgba(200,16,46,0.4); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN LAYOUT & SECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.main-container {
  max-width: 1240px; margin: 0 auto; padding: 0 28px 100px;
}

.section-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 28px;
}

.section-title { font-size: 23px; font-weight: 900; }
.section-title .red { color: var(--red); }

.count-badge {
  background: var(--bg2); border: 1px solid var(--border);
  padding: 6px 16px; border-radius: 100px;
  font-size: 13px; color: var(--text2); font-weight: 600;
}

.sort-row {
  display: flex; gap: 8px; margin-bottom: 24px; flex-wrap: wrap;
}
.sort-btn {
  padding: 7px 16px; border-radius: 10px; border: 1px solid var(--border);
  background: var(--bg2); color: var(--text2); font-family: var(--font);
  font-size: 12px; font-weight: 700; cursor: pointer; transition: all 0.2s;
}
.sort-btn.active { background: var(--red); border-color: var(--red); color: white; }
.sort-btn:hover:not(.active) { border-color: var(--border-red); color: white; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CARS GRID
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cars-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(290px, 1fr));
  gap: 22px;
}

.car-card {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--radius); overflow: hidden;
  transition: all 0.28s cubic-bezier(0.4,0,0.2,1);
  cursor: pointer; text-decoration: none; color: inherit;
  position: relative;
}

.car-card::before {
  content: '';
  position: absolute; inset: 0;
  background: linear-gradient(135deg, transparent 60%, rgba(200,16,46,0.03) 100%);
  opacity: 0; transition: opacity 0.3s;
  pointer-events: none; z-index: 1;
}

.car-card:hover {
  border-color: var(--border-red);
  transform: translateY(-5px);
  box-shadow: 0 16px 48px rgba(200,16,46,0.12), 0 4px 16px rgba(0,0,0,0.4);
  background: var(--card-hover);
}
.car-card:hover::before { opacity: 1; }

/* Image */
.car-img-wrap { position: relative; overflow: hidden; }

.car-img {
  width: 100%; height: 210px;
  object-fit: cover; display: block;
  transition: transform 0.4s ease;
}
.car-card:hover .car-img { transform: scale(1.04); }

.car-img-placeholder {
  width: 100%; height: 210px;
  background: linear-gradient(135deg, var(--bg3) 0%, var(--bg2) 100%);
  display: flex; align-items: center; justify-content: center;
  font-size: 52px;
}

.car-badges {
  position: absolute; top: 12px; right: 12px;
  display: flex; gap: 5px; flex-wrap: wrap; z-index: 2;
}

.badge {
  padding: 4px 10px; border-radius: 100px;
  font-size: 10px; font-weight: 800; backdrop-filter: blur(8px);
}
.badge-new { background: rgba(74,222,128,0.18); color: #4ade80; border: 1px solid rgba(74,222,128,0.35); }
.badge-featured { background: rgba(212,175,55,0.18); color: var(--gold); border: 1px solid rgba(212,175,55,0.35); }
.badge-sold { background: rgba(239,68,68,0.18); color: #ef4444; border: 1px solid rgba(239,68,68,0.35); }

.car-img-count {
  position: absolute; bottom: 10px; left: 10px; z-index: 2;
  background: rgba(0,0,0,0.65); backdrop-filter: blur(8px);
  padding: 3px 9px; border-radius: 7px;
  font-size: 11px; color: var(--text2); font-weight: 700;
}

/* Card body */
.car-body { padding: 18px; }

.car-title {
  font-size: 18px; font-weight: 900;
  margin-bottom: 4px; line-height: 1.25;
  letter-spacing: -0.2px;
}

.car-sub { font-size: 13px; color: var(--text2); margin-bottom: 14px; }

.car-price-row { display: flex; align-items: baseline; gap: 6px; margin-bottom: 14px; }
.car-price { font-size: 24px; font-weight: 900; color: white; }
.car-price-label { font-size: 12px; color: var(--text3); }

.car-specs {
  display: flex; gap: 7px; flex-wrap: wrap; margin-bottom: 14px;
}

.spec-tag {
  background: var(--bg3); border: 1px solid var(--border);
  padding: 5px 11px; border-radius: 9px;
  font-size: 12px; color: var(--text2);
  display: flex; align-items: center; gap: 4px; font-weight: 600;
}

.car-footer {
  display: flex; align-items: center; justify-content: space-between;
  padding-top: 13px; border-top: 1px solid var(--border);
}

.car-city {
  font-size: 12px; color: var(--text3);
  display: flex; align-items: center; gap: 4px; font-weight: 600;
}

.car-contact { display: flex; gap: 6px; }

.wa-btn, .call-btn {
  width: 34px; height: 34px; border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  text-decoration: none; font-size: 16px; transition: all 0.2s;
}
.wa-btn { background: rgba(37,211,102,0.1); border: 1px solid rgba(37,211,102,0.2); }
.wa-btn:hover { background: rgba(37,211,102,0.22); transform: scale(1.08); }
.call-btn { background: rgba(96,165,250,0.1); border: 1px solid rgba(96,165,250,0.2); }
.call-btn:hover { background: rgba(96,165,250,0.22); transform: scale(1.08); }

/* Pending bar */
.status-pending-bar {
  background: rgba(234,179,8,0.08);
  border-bottom: 1px solid rgba(234,179,8,0.2);
  padding: 7px 14px; font-size: 11px; color: #eab308; font-weight: 800;
  display: flex; align-items: center; gap: 6px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EMPTY / LOADING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.empty-state {
  text-align: center; padding: 90px 24px; color: var(--text2);
  grid-column: 1 / -1;
}
.empty-icon { font-size: 70px; margin-bottom: 20px; }
.empty-state h3 { font-size: 22px; font-weight: 800; color: white; margin-bottom: 10px; }

.loading { text-align: center; padding: 80px; grid-column: 1 / -1; }
.spinner {
  width: 44px; height: 44px; border-radius: 50%;
  border: 3px solid var(--border);
  border-top-color: var(--red);
  animation: spin 0.8s linear infinite;
  margin: 0 auto 18px;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MODAL BASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.modal-overlay {
  position: fixed; inset: 0; z-index: 1000;
  background: rgba(0,0,0,0.88); backdrop-filter: blur(16px);
  display: flex; align-items: center; justify-content: center;
  padding: 16px; opacity: 0; pointer-events: none;
  transition: opacity 0.25s;
}
.modal-overlay.open { opacity: 1; pointer-events: all; }

.modal {
  background: var(--bg2); border: 1px solid var(--border);
  border-radius: 24px; width: 100%; max-width: 660px;
  max-height: 92vh; overflow-y: auto;
  transform: scale(0.96) translateY(18px);
  transition: transform 0.28s cubic-bezier(0.4,0,0.2,1);
}
.modal-overlay.open .modal { transform: scale(1) translateY(0); }

.modal-header {
  padding: 22px 24px 18px;
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between;
  position: sticky; top: 0; background: var(--bg2); z-index: 1;
}
.modal-title { font-size: 19px; font-weight: 900; }
.modal-close {
  width: 36px; height: 36px; border-radius: 10px;
  background: var(--bg3); border: 1px solid var(--border);
  color: var(--text2); font-size: 18px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.2s;
}
.modal-close:hover { color: white; border-color: rgba(255,255,255,0.2); }
.modal-body { padding: 24px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FORM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
.form-group { display: flex; flex-direction: column; gap: 6px; }
.form-group.full { grid-column: 1 / -1; }
.form-label { font-size: 12px; font-weight: 800; color: var(--text2); text-transform: uppercase; letter-spacing: 0.06em; }

.form-input, .form-select, .form-textarea {
  background: var(--bg3); border: 1px solid var(--border);
  color: white; padding: 12px 15px; border-radius: 11px;
  font-family: var(--font); font-size: 14px; outline: none;
  transition: all 0.2s; width: 100%;
}
.form-input:focus, .form-select:focus, .form-textarea:focus {
  border-color: var(--red);
  box-shadow: 0 0 0 3px rgba(200,16,46,0.1);
}
.form-textarea { resize: vertical; min-height: 85px; }

.section-divider {
  font-size: 11px; font-weight: 900; color: var(--red);
  text-transform: uppercase; letter-spacing: 0.18em;
  margin: 22px 0 16px; padding-bottom: 9px;
  border-bottom: 1px solid var(--border-red);
  display: flex; align-items: center; gap: 8px;
}

/* Upload area */
.upload-area {
  border: 2px dashed rgba(255,255,255,0.1); border-radius: 14px;
  padding: 30px; text-align: center; cursor: pointer;
  transition: all 0.2s; background: rgba(255,255,255,0.02);
}
.upload-area:hover {
  border-color: var(--red);
  background: rgba(200,16,46,0.04);
}
.upload-icon { font-size: 38px; margin-bottom: 10px; }
.upload-text { font-size: 14px; color: var(--text2); }
.upload-text strong { color: var(--red); }

.preview-grid { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 14px; }
.preview-wrap { position: relative; }
.preview-img { width: 82px; height: 82px; border-radius: 12px; object-fit: cover; }
.preview-remove {
  position: absolute; top: -5px; right: -5px;
  width: 20px; height: 20px; border-radius: 50%;
  background: var(--red); color: white; border: none;
  font-size: 12px; cursor: pointer; display: flex;
  align-items: center; justify-content: center; font-weight: 900;
}

.submit-btn {
  width: 100%; padding: 16px; border-radius: 14px;
  background: linear-gradient(135deg, var(--red), #e0162f);
  color: white; border: none;
  font-family: var(--font); font-size: 16px; font-weight: 900;
  cursor: pointer; margin-top: 22px; transition: all 0.2s;
  box-shadow: 0 6px 24px rgba(200,16,46,0.35);
  letter-spacing: 0.02em;
}
.submit-btn:hover:not(:disabled) { transform: translateY(-1px); box-shadow: 0 8px 28px rgba(200,16,46,0.45); }
.submit-btn:disabled { opacity: 0.45; cursor: not-allowed; transform: none; }

.upload-progress {
  margin-top: 12px; height: 4px; background: var(--bg3);
  border-radius: 2px; overflow: hidden; display: none;
}
.upload-progress-bar {
  height: 100%; background: linear-gradient(90deg, var(--red), #ff4060);
  border-radius: 2px; transition: width 0.3s;
}

.success-msg { text-align: center; padding: 44px 24px; }
.success-icon { font-size: 72px; margin-bottom: 18px; }
.success-msg h3 { font-size: 24px; font-weight: 900; margin-bottom: 10px; }
.success-msg p { color: var(--text2); font-size: 15px; line-height: 1.65; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CAR DETAIL MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.detail-gallery { position: relative; margin-bottom: 20px; }
.detail-img-main {
  width: 100%; height: 300px; object-fit: cover;
  border-radius: 16px; display: block;
}
.detail-thumbs {
  display: flex; gap: 8px; overflow-x: auto;
  padding: 10px 0 4px; scrollbar-width: none;
}
.detail-thumbs::-webkit-scrollbar { display: none; }
.detail-thumb {
  width: 76px; height: 56px; object-fit: cover;
  border-radius: 10px; cursor: pointer; flex-shrink: 0;
  border: 2px solid transparent; transition: all 0.2s;
}
.detail-thumb.active { border-color: var(--red); }
.detail-thumb:hover { border-color: var(--border-red); }

.detail-header-row {
  display: flex; align-items: flex-start;
  justify-content: space-between; margin-bottom: 16px;
}
.detail-title-group {}
.detail-car-name { font-size: 26px; font-weight: 900; line-height: 1.2; }
.detail-car-sub { font-size: 14px; color: var(--text2); margin-top: 4px; }

.detail-price { font-size: 30px; font-weight: 900; color: white; text-align: left; }
.detail-price-label { font-size: 11px; color: var(--text3); text-align: left; font-weight: 600; }

.detail-specs {
  display: grid; grid-template-columns: repeat(3, 1fr);
  gap: 10px; margin: 18px 0;
}
.detail-spec {
  background: var(--bg3); border: 1px solid var(--border);
  padding: 13px 12px; border-radius: 13px; text-align: center;
}
.detail-spec-val { font-size: 15px; font-weight: 800; }
.detail-spec-key { font-size: 11px; color: var(--text3); margin-top: 3px; font-weight: 600; }

.detail-desc {
  background: var(--bg3); border: 1px solid var(--border);
  border-radius: 13px; padding: 16px; margin: 16px 0;
  font-size: 14px; color: var(--text2); line-height: 1.7;
}

.seller-card {
  background: var(--bg3); border: 1px solid var(--border);
  border-radius: 13px; padding: 16px; margin: 16px 0;
  display: flex; align-items: center; gap: 14px;
}
.seller-avatar {
  width: 48px; height: 48px; border-radius: 14px;
  background: linear-gradient(135deg, var(--red), #e0162f);
  display: flex; align-items: center; justify-content: center;
  font-size: 22px; flex-shrink: 0;
}
.seller-name { font-weight: 800; font-size: 15px; }
.seller-city { font-size: 12px; color: var(--text2); margin-top: 2px; }

.contact-bar {
  display: flex; gap: 10px; margin-top: 20px;
}
.contact-bar a {
  flex: 1; display: flex; align-items: center; justify-content: center;
  gap: 8px; padding: 15px; border-radius: 14px;
  font-family: var(--font); font-weight: 800; font-size: 15px;
  text-decoration: none; transition: all 0.2s;
}
.contact-wa {
  background: rgba(37,211,102,0.1); color: #25d366;
  border: 1px solid rgba(37,211,102,0.25);
}
.contact-wa:hover { background: rgba(37,211,102,0.18); transform: translateY(-1px); }
.contact-call {
  background: rgba(96,165,250,0.1); color: #60a5fa;
  border: 1px solid rgba(96,165,250,0.25);
}
.contact-call:hover { background: rgba(96,165,250,0.18); transform: translateY(-1px); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.toast {
  position: fixed; bottom: 26px; left: 50%;
  transform: translateX(-50%) translateY(100px);
  background: var(--bg2); border: 1px solid var(--border);
  padding: 13px 26px; border-radius: 100px;
  font-size: 14px; font-weight: 700;
  z-index: 9999; transition: transform 0.35s cubic-bezier(0.4,0,0.2,1);
  white-space: nowrap; pointer-events: none;
  backdrop-filter: blur(12px);
}
.toast.show { transform: translateX(-50%) translateY(0); }
.toast.success { border-color: rgba(74,222,128,0.4); color: #4ade80; }
.toast.error { border-color: rgba(239,68,68,0.4); color: #ef4444; }
.toast.info { border-color: rgba(96,165,250,0.4); color: #60a5fa; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FEATURES STRIP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.features-strip {
  padding: 22px 28px;
  display: flex; justify-content: center; gap: 0;
  background: var(--bg2); border-top: 1px solid var(--border);
  border-bottom: 1px solid var(--border);
  overflow-x: auto;
}
.feature-item {
  display: flex; align-items: center; gap: 8px;
  padding: 0 28px; font-size: 13px; font-weight: 700; color: var(--text2);
  white-space: nowrap;
}
.feature-item:not(:last-child) { border-left: 1px solid var(--border); }
.feature-item span.icon { font-size: 18px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FOOTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
footer {
  text-align: center; padding: 36px 24px;
  border-top: 1px solid var(--border);
  color: var(--text3); font-size: 13px;
}
footer strong { color: var(--red); }
footer .footer-admin {
  cursor: pointer; opacity: 0.2; transition: opacity 0.2s;
  user-select: none;
}
footer .footer-admin:hover { opacity: 0.5; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media (max-width: 640px) {
  nav { padding: 0 16px; }
  .nav-center { display: none; }
  .hero { padding: 100px 16px 56px; }
  .hero h1 { font-size: 2.1rem; }
  .search-section { padding: 0 16px 40px; }
  .main-container { padding: 0 16px 80px; }
  .cars-grid { grid-template-columns: 1fr; }
  .form-grid { grid-template-columns: 1fr; }
  .detail-specs { grid-template-columns: repeat(2,1fr); }
  .features-strip { justify-content: flex-start; }
  .hero-stats { flex-direction: row; }
  .contact-bar { flex-direction: column; }
}
</style>
</head>
<body>

<!-- â”€â”€ NAV â”€â”€ -->
<nav>
  <a href="#" class="nav-logo" onclick="showHome()">
    <div class="nav-logo-icon">ğŸš—</div>
    <span class="nav-logo-text"><span>YOUGO</span> CARS</span>
  </a>
  <div class="nav-center">
    <button class="nav-link" onclick="scrollToListings()">××•×“×¢×•×ª</button>
    <button class="nav-link" onclick="openAddModal()">×¤×¨×¡× ×¨×›×‘</button>
  </div>
  <div class="nav-actions">
    <button class="lang-btn" onclick="cycleLang()" id="langBtn">ğŸ‡¦ğŸ‡ª Ø¹Ø±Ø¨ÙŠ</button>
    <button class="btn btn-red" onclick="openAddModal()">+ <span>×¤×¨×¡× ×¨×›×‘</span></button>
  </div>
</nav>

<!-- â”€â”€ ADMIN BAR (hidden) â”€â”€ -->
<div id="adminBar" style="display:none;margin-top:66px" class="admin-bar">
  <span class="admin-bar-title">ğŸ”‘ Admin Mode</span>
  <div class="admin-actions" id="adminActions"></div>
</div>

<!-- â”€â”€ HERO â”€â”€ -->
<div class="hero" id="heroSection" style="margin-top:66px">
  <div class="hero-bg"></div>
  <div class="hero-grid"></div>
  <div class="hero-content">
    <div class="hero-badge">
      <div class="dot"></div>
      <span id="heroBadgeText">YOUGO ISRAEL â€” ×”×¤×œ×˜×¤×•×¨××” ×”××•×‘×™×œ×”</span>
    </div>
    <h1 id="heroTitle">×©×•×§ ×”×¨×›×‘×™× <span class="red">×”×“×™×’×™×˜×œ×™</span><br>×©×œ ×™×©×¨××œ</h1>
    <p class="hero-sub" id="heroSub">×§× ×” ×•××›×•×¨ ×¨×›×‘ ×‘×§×œ×•×ª ×•×‘××”×™×¨×•×ª. ××•×“×¢×•×ª ×××•××ª×•×ª ×¢× ××¤×©×¨×•×ª ×™×¦×™×¨×ª ×§×©×¨ ××™×™×“×™×ª.</p>
    <div class="hero-btns">
      <button class="btn btn-red" style="padding:15px 34px;font-size:16px" onclick="openAddModal()" id="heroAddBtn">ğŸš— ×¤×¨×¡× ×¨×›×‘ ×‘×—×™× ×</button>
      <button class="btn btn-ghost" style="padding:15px 34px;font-size:16px" onclick="scrollToListings()" id="heroBrowseBtn">ğŸ” ×—×¤×© ×¨×›×‘</button>
    </div>
    <div class="hero-stats">
      <div class="hero-stat">
        <div class="hero-stat-val" id="statCars">0</div>
        <div class="hero-stat-label" id="statCarsLabel">××•×“×¢×•×ª ×¤×¢×™×œ×•×ª</div>
      </div>
      <div class="hero-stat">
        <div class="hero-stat-val">50K<span class="accent">+</span></div>
        <div class="hero-stat-label" id="statFollowers">×¢×•×§×‘×™×</div>
      </div>
      <div class="hero-stat">
        <div class="hero-stat-val">100<span class="accent">%</span></div>
        <div class="hero-stat-label" id="statFree">×—×™× × ×œ×¤×¨×¡×</div>
      </div>
    </div>
  </div>
</div>

<!-- â”€â”€ FEATURES STRIP â”€â”€ -->
<div class="features-strip">
  <div class="feature-item"><span class="icon">âœ…</span> ×¤×¨×¡×•× ×—×™× ××™</div>
  <div class="feature-item"><span class="icon">âš¡</span> ×¤×¨×¡×•× ××™×™×“×™</div>
  <div class="feature-item"><span class="icon">ğŸ“±</span> ×¤× ×™×™×” ×‘-WhatsApp</div>
  <div class="feature-item"><span class="icon">ğŸ”’</span> ×××•×‘×˜×— ×•×‘×˜×•×—</div>
  <div class="feature-item"><span class="icon">ğŸŒ</span> ×¢×‘×¨×™×ª | Ø¹Ø±Ø¨ÙŠØ© | English</div>
</div>

<!-- â”€â”€ SEARCH â”€â”€ -->
<div class="search-section" style="padding-top:40px">
  <div class="search-box">
    <div class="search-row">
      <input class="search-input" id="searchText" placeholder="ğŸ” ×—×¤×© ×œ×¤×™ ×™×¦×¨×Ÿ, ×“×’×, ×¢×™×¨..." oninput="filterCars()">
      <button class="search-btn" onclick="filterCars()" id="searchBtnEl">×—×¤×©</button>
    </div>
    <div class="filter-row">
      <select class="filter-select" id="filterMake" onchange="filterCars()">
        <option value="">×›×œ ×”×™×¦×¨× ×™×</option>
      </select>
      <select class="filter-select" id="filterYear" onchange="filterCars()">
        <option value="">×›×œ ×”×©× ×™×</option>
      </select>
      <select class="filter-select" id="filterMaxPrice" onchange="filterCars()">
        <option value="">×›×œ ×”××—×™×¨×™×</option>
        <option value="30000">×¢×“ â‚ª30,000</option>
        <option value="50000">×¢×“ â‚ª50,000</option>
        <option value="80000">×¢×“ â‚ª80,000</option>
        <option value="100000">×¢×“ â‚ª100,000</option>
        <option value="150000">×¢×“ â‚ª150,000</option>
        <option value="200000">×¢×“ â‚ª200,000</option>
        <option value="300000">×¢×“ â‚ª300,000</option>
      </select>
      <select class="filter-select" id="filterCity" onchange="filterCars()">
        <option value="">×›×œ ×”×¢×¨×™×</option>
      </select>
      <select class="filter-select" id="filterGear" onchange="filterCars()">
        <option value="">×›×œ ×”×’×™×¨×™×</option>
        <option value="××•×˜×•××˜">××•×˜×•××˜</option>
        <option value="×™×“× ×™">×™×“× ×™</option>
        <option value="CVT">CVT</option>
      </select>
      <select class="filter-select" id="filterFuel" onchange="filterCars()">
        <option value="">×›×œ ×”×“×œ×§×™×</option>
        <option value="×‘× ×–×™×Ÿ">×‘× ×–×™×Ÿ</option>
        <option value="×“×™×–×œ">×“×™×–×œ</option>
        <option value="×”×™×‘×¨×™×“×™">×”×™×‘×¨×™×“×™</option>
        <option value="×—×©××œ×™">×—×©××œ×™</option>
      </select>
    </div>
  </div>
</div>

<!-- â”€â”€ LISTINGS â”€â”€ -->
<div class="main-container" id="listingsSection">
  <div class="section-header">
    <h2 class="section-title" id="sectionTitle">××•×“×¢×•×ª <span class="red">×¤×¢×™×œ×•×ª</span></h2>
    <span class="count-badge" id="countBadge">×˜×•×¢×Ÿ...</span>
  </div>
  <div class="sort-row">
    <button class="sort-btn active" onclick="sortCars('newest',this)">ğŸ†• ×”×—×“×©×™× ×‘×™×•×ª×¨</button>
    <button class="sort-btn" onclick="sortCars('price_asc',this)">ğŸ’° ××—×™×¨: × ××•×š ×œ×’×‘×•×”</button>
    <button class="sort-btn" onclick="sortCars('price_desc',this)">ğŸ’ ××—×™×¨: ×’×‘×•×” ×œ× ××•×š</button>
    <button class="sort-btn" onclick="sortCars('km_asc',this)">ğŸ“ ×§"× × ××•×š</button>
  </div>
  <div id="carsContainer">
    <div class="loading" style="grid-column:1/-1">
      <div class="spinner"></div>
      <p style="color:var(--text2);font-weight:600">×˜×•×¢×Ÿ ××•×“×¢×•×ª...</p>
    </div>
  </div>
</div>

<!-- â”€â”€ FOOTER â”€â”€ -->
<footer>
  <p>Â© 2026 <strong>YOUGO CARS</strong> â€” ×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª</p>
  <p style="margin-top:6px">×¤×¨×¡× ×¨×›×‘ ×‘×—×™× × ×•××›×•×¨ ××”×¨ ×™×•×ª×¨ ×¢× YOUGO ISRAEL</p>
  <p style="margin-top:12px">
    <span class="footer-admin" onclick="adminLogin()">â—</span>
  </p>
</footer>

<!-- â”€â”€ ADD CAR MODAL â”€â”€ -->
<div class="modal-overlay" id="addModal" onclick="handleModalClick(event,'addModal')">
  <div class="modal" onclick="event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title" id="addModalTitle">ğŸš— ×¤×¨×¡× ××ª ×”×¨×›×‘ ×©×œ×š</h3>
      <button class="modal-close" onclick="closeAddModal()">Ã—</button>
    </div>
    <div class="modal-body" id="addModalBody">
      <form id="addCarForm" onsubmit="submitCar(event)">
        <div class="section-divider">ğŸš— ×¤×¨×˜×™ ×”×¨×›×‘</div>
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">×™×¦×¨×Ÿ *</label>
            <input class="form-input" id="f_make" placeholder="Toyota, BMW, Hyundai..." required>
          </div>
          <div class="form-group">
            <label class="form-label">×“×’× *</label>
            <input class="form-input" id="f_model" placeholder="Corolla, X5..." required>
          </div>
          <div class="form-group">
            <label class="form-label">×©× ×” *</label>
            <input class="form-input" id="f_year" type="number" min="1990" max="2026" placeholder="2022" required>
          </div>
          <div class="form-group">
            <label class="form-label">××—×™×¨ â‚ª *</label>
            <input class="form-input" id="f_price" type="number" placeholder="80000" required>
          </div>
          <div class="form-group">
            <label class="form-label">×§×™×œ×•××˜×¨××–'</label>
            <input class="form-input" id="f_mileage" type="number" placeholder="50000">
          </div>
          <div class="form-group">
            <label class="form-label">×™×“</label>
            <select class="form-select" id="f_hand">
              <option value="1">×™×“ ×¨××©×•× ×”</option>
              <option value="2" selected>×™×“ ×©× ×™×™×”</option>
              <option value="3">×™×“ ×©×œ×™×©×™×ª</option>
              <option value="4">×™×“ ×¨×‘×™×¢×™×ª+</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">×ª×™×‘×ª ×”×™×œ×•×›×™×</label>
            <select class="form-select" id="f_gear">
              <option value="××•×˜×•××˜">××•×˜×•××˜×™</option>
              <option value="×™×“× ×™">×™×“× ×™</option>
              <option value="CVT">CVT</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">×¡×•×’ ×“×œ×§</label>
            <select class="form-select" id="f_fuel">
              <option value="×‘× ×–×™×Ÿ">×‘× ×–×™×Ÿ</option>
              <option value="×“×™×–×œ">×“×™×–×œ</option>
              <option value="×”×™×‘×¨×™×“×™">×”×™×‘×¨×™×“×™</option>
              <option value="×—×©××œ×™">×—×©××œ×™</option>
              <option value="×’×–">×’×–</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">×¦×‘×¢</label>
            <input class="form-input" id="f_color" placeholder="×œ×‘×Ÿ, ×©×—×•×¨, ×›×¡×•×£...">
          </div>
          <div class="form-group">
            <label class="form-label">× ×¤×— ×× ×•×¢ (×œ×™×˜×¨)</label>
            <input class="form-input" id="f_engine" type="number" step="0.1" placeholder="1.6">
          </div>
        </div>

        <div class="section-divider" style="margin-top:20px">ğŸ“ ×ª×™××•×¨</div>
        <div class="form-group">
          <label class="form-label">×ª×™××•×¨ ×‘×¢×‘×¨×™×ª</label>
          <textarea class="form-textarea" id="f_desc_he" placeholder="×ª××¨ ××ª ××¦×‘ ×”×¨×›×‘, ×ª×•×¡×¤×•×ª, ×”×™×¡×˜×•×¨×™×”..."></textarea>
        </div>
        <div class="form-group" style="margin-top:12px">
          <label class="form-label">ÙˆØµÙ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</label>
          <textarea class="form-textarea" id="f_desc_ar" placeholder="Ø§ÙƒØªØ¨ ÙˆØµÙ Ø§Ù„Ø³ÙŠØ§Ø±Ø©ØŒ Ø§Ù„Ø­Ø§Ù„Ø©ØŒ Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª..."></textarea>
        </div>

        <div class="section-divider" style="margin-top:20px">ğŸ“· ×ª××•× ×•×ª</div>
        <div class="upload-area" onclick="document.getElementById('imgInput').click()" id="uploadArea">
          <div class="upload-icon">ğŸ“·</div>
          <div class="upload-text" id="uploadText">×œ×—×¥ ×œ×”×•×¡×¤×ª ×ª××•× ×•×ª <strong>(×¢×“ 10)</strong></div>
        </div>
        <input type="file" id="imgInput" multiple accept="image/*" style="display:none" onchange="handleImages(this)">
        <div class="upload-progress" id="uploadProgress">
          <div class="upload-progress-bar" id="uploadProgressBar"></div>
        </div>
        <div class="preview-grid" id="previewGrid"></div>

        <div class="section-divider" style="margin-top:20px">ğŸ‘¤ ×¤×¨×˜×™ ×”××•×›×¨</div>
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">×©× ××œ× *</label>
            <input class="form-input" id="f_name" placeholder="×™×©×¨××œ ×™×©×¨××œ×™" required>
          </div>
          <div class="form-group">
            <label class="form-label">×˜×œ×¤×•×Ÿ *</label>
            <input class="form-input" id="f_phone" placeholder="050-0000000" required>
          </div>
          <div class="form-group full">
            <label class="form-label">×¢×™×¨ *</label>
            <input class="form-input" id="f_city" placeholder="×ª×œ ××‘×™×‘, ×—×™×¤×”, ×™×¨×•×©×œ×™×..." required>
          </div>
        </div>

        <button type="submit" class="submit-btn" id="submitBtn">ğŸš— ×¤×¨×¡× ××•×“×¢×” ×‘×—×™× × â€” ××™×™×“×™!</button>
      </form>
    </div>
  </div>
</div>

<!-- â”€â”€ CAR DETAIL MODAL â”€â”€ -->
<div class="modal-overlay" id="detailModal" onclick="handleModalClick(event,'detailModal')">
  <div class="modal" style="max-width:720px" onclick="event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title" id="detailTitle">×¤×¨×˜×™ ×”×¨×›×‘</h3>
      <button class="modal-close" onclick="closeDetailModal()">Ã—</button>
    </div>
    <div class="modal-body" id="detailBody"></div>
  </div>
</div>

<!-- â”€â”€ TOAST â”€â”€ -->
<div class="toast" id="toast"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SUPABASE CONFIG â€” ×”×—×œ×£ ×›××Ÿ!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SUPABASE_URL = 'https://arsbodqhmmtmoqqhykep.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFyc2JvZHFobW10bW9xcWh5a2VwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIxNTgxMTQsImV4cCI6MjA4NzczNDExNH0.mt_WpPshp5xdbIx23pMmcwq7MhktA0-vWPIstOy1_HM';
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CLOUDINARY CONFIG â€” ×”×›× ×¡ ××ª ×”×¤×¨×˜×™× ×©×œ×š ××—×¨×™ ×”×”×¨×©××”!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CLOUDINARY_CLOUD_NAME = 'dbd2dgqti';
const CLOUDINARY_UPLOAD_PRESET = 'htxdjln0';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ADMIN CONFIG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ADMIN_PASS = 'yougo2026';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let allCars = [];
let filteredCars = [];
let uploadedImages = [];
let isAdmin = false;
let currentLang = 'he';
let currentSort = 'newest';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TRANSLATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const T = {
  he: {
    heroBadge: 'YOUGO ISRAEL â€” ×”×¤×œ×˜×¤×•×¨××” ×”××•×‘×™×œ×”',
    heroTitle: '×©×•×§ ×”×¨×›×‘×™× <span class="red">×”×“×™×’×™×˜×œ×™</span><br>×©×œ ×™×©×¨××œ',
    heroSub: '×§× ×” ×•××›×•×¨ ×¨×›×‘ ×‘×§×œ×•×ª ×•×‘××”×™×¨×•×ª. ××•×“×¢×•×ª ×××•××ª×•×ª ×¢× ××¤×©×¨×•×ª ×™×¦×™×¨×ª ×§×©×¨ ××™×™×“×™×ª.',
    heroAdd: 'ğŸš— ×¤×¨×¡× ×¨×›×‘ ×‘×—×™× ×',
    heroBrowse: 'ğŸ” ×—×¤×© ×¨×›×‘',
    statCarsLabel: '××•×“×¢×•×ª ×¤×¢×™×œ×•×ª',
    statFollowers: '×¢×•×§×‘×™×',
    statFree: '×—×™× × ×œ×¤×¨×¡×',
    sectionTitle: '××•×“×¢×•×ª <span class="red">×¤×¢×™×œ×•×ª</span>',
    addModalTitle: 'ğŸš— ×¤×¨×¡× ××ª ×”×¨×›×‘ ×©×œ×š',
    submitBtn: 'ğŸš— ×¤×¨×¡× ××•×“×¢×” ×‘×—×™× × â€” ××™×™×“×™!',
    uploadText: '×œ×—×¥ ×œ×”×•×¡×¤×ª ×ª××•× ×•×ª <strong>(×¢×“ 10)</strong>',
    pendingMsg: 'âœ… ×”××•×“×¢×” ×¤×•×¨×¡××”! ×”×™× ×–××™× ×” ×›×¢×ª ×œ×›×•×œ×.',
    allMakes: '×›×œ ×”×™×¦×¨× ×™×', allYears: '×›×œ ×”×©× ×™×',
    allPrices: '×›×œ ×”××—×™×¨×™×', allCities: '×›×œ ×”×¢×¨×™×', allGears: '×›×œ ×”×’×™×¨×™×',
    noCars: '××™×Ÿ ××•×“×¢×•×ª ×ª×•×××•×ª', noCarsDesc: '× ×¡×” ×œ×©× ×•×ª ××ª ×¤×¨××˜×¨×™ ×”×—×™×¤×•×©',
    sold: '× ××›×¨', featured: '××•××œ×¥', newBadge: 'âœ¨ ×—×“×©',
    dir: 'rtl', lang: 'ğŸ‡¦ğŸ‡ª Ø¹Ø±Ø¨ÙŠ', addCar: '×¤×¨×¡× ×¨×›×‘',
    km: '×§"×', contact: '×¤×¨×˜×™ ×§×©×¨', whatsapp: '×©×œ×— WhatsApp', call: '×”×ª×§×©×¨',
    year: '×©× ×”', price: '××—×™×¨', hand: '×™×“', gear: '×’×™×¨', fuel: '×“×œ×§', color: '×¦×‘×¢',
    seller: '×”××•×›×¨', city: '×¢×™×¨', description: '×ª×™××•×¨',
    searchBtn: '×—×¤×©', mileage: '×§"×'
  },
  ar: {
    heroBadge: 'YOUGO ISRAEL â€” Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø±Ø§Ø¦Ø¯Ø©',
    heroTitle: 'Ø³ÙˆÙ‚ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª <span class="red">Ø§Ù„Ø±Ù‚Ù…ÙŠ</span><br>ÙÙŠ Ø¥Ø³Ø±Ø§Ø¦ÙŠÙ„',
    heroSub: 'Ø§Ø´ØªØ±Ù ÙˆØ¨ÙØ¹ Ø³ÙŠØ§Ø±ØªÙƒ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ³Ø±Ø¹Ø©. Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…ÙˆØ«Ù‚Ø© Ù…Ø¹ ØªÙˆØ§ØµÙ„ ÙÙˆØ±ÙŠ.',
    heroAdd: 'ğŸš— Ø£Ø¹Ù„Ù† Ø¹Ù† Ø³ÙŠØ§Ø±ØªÙƒ Ù…Ø¬Ø§Ù†Ø§Ù‹',
    heroBrowse: 'ğŸ” ØªØµÙØ­ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª',
    statCarsLabel: 'Ø¥Ø¹Ù„Ø§Ù† Ù†Ø´Ø·',
    statFollowers: 'Ù…ØªØ§Ø¨Ø¹',
    statFree: 'Ù†Ø´Ø± Ù…Ø¬Ø§Ù†ÙŠ',
    sectionTitle: 'Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª <span class="red">Ø§Ù„Ù†Ø´Ø·Ø©</span>',
    addModalTitle: 'ğŸš— Ø£Ø¶Ù Ø¥Ø¹Ù„Ø§Ù†Ùƒ',
    submitBtn: 'ğŸš— Ø§Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ø¢Ù† â€” Ù…Ø¬Ø§Ù†Ø§Ù‹!',
    uploadText: 'Ø§Ù†Ù‚Ø± Ù„Ø¥Ø¶Ø§ÙØ© ØµÙˆØ± <strong>(Ø­ØªÙ‰ 10)</strong>',
    pendingMsg: 'âœ… ØªÙ… Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù†Ùƒ! Ù…ØªØ§Ø­ Ø§Ù„Ø¢Ù† Ù„Ù„Ø¬Ù…ÙŠØ¹.',
    allMakes: 'ÙƒÙ„ Ø§Ù„Ù…Ø§Ø±ÙƒØ§Øª', allYears: 'ÙƒÙ„ Ø§Ù„Ø³Ù†ÙˆØ§Øª',
    allPrices: 'ÙƒÙ„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±', allCities: 'ÙƒÙ„ Ø§Ù„Ù…Ø¯Ù†', allGears: 'ÙƒÙ„ Ø§Ù„Ù†Ø§Ù‚Ù„Ø§Øª',
    noCars: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª', noCarsDesc: 'Ø¬Ø±Ù‘Ø¨ ØªØºÙŠÙŠØ± Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¨Ø­Ø«',
    sold: 'Ù…Ø¨Ø§Ø¹', featured: 'Ù…Ù…ÙŠØ²', newBadge: 'âœ¨ Ø¬Ø¯ÙŠØ¯',
    dir: 'rtl', lang: 'ğŸ‡®ğŸ‡± ×¢×‘×¨×™×ª', addCar: 'Ø£Ø¹Ù„Ù† Ø¹Ù† Ø³ÙŠØ§Ø±ØªÙƒ',
    km: 'ÙƒÙ…', contact: 'ØªÙˆØ§ØµÙ„', whatsapp: 'ÙˆØ§ØªØ³Ø§Ø¨', call: 'Ø§ØªØµÙ„',
    year: 'Ø³Ù†Ø©', price: 'Ø³Ø¹Ø±', hand: 'ÙŠØ¯', gear: 'Ù†Ø§Ù‚Ù„', fuel: 'ÙˆÙ‚ÙˆØ¯', color: 'Ù„ÙˆÙ†',
    seller: 'Ø§Ù„Ø¨Ø§Ø¦Ø¹', city: 'Ù…Ø¯ÙŠÙ†Ø©', description: 'ÙˆØµÙ',
    searchBtn: 'Ø¨Ø­Ø«', mileage: 'ÙƒÙ…'
  },
  en: {
    heroBadge: 'YOUGO ISRAEL â€” The Leading Platform',
    heroTitle: 'Israel\'s <span class="red">Digital</span><br>Car Market',
    heroSub: 'Buy and sell cars easily and fast. Verified listings with instant contact.',
    heroAdd: 'ğŸš— Post Your Car for Free',
    heroBrowse: 'ğŸ” Browse Cars',
    statCarsLabel: 'Active Listings',
    statFollowers: 'Followers',
    statFree: 'Free to Post',
    sectionTitle: '<span class="red">Active</span> Listings',
    addModalTitle: 'ğŸš— Post Your Car',
    submitBtn: 'ğŸš— Post Now â€” Instantly Free!',
    uploadText: 'Click to add photos <strong>(up to 10)</strong>',
    pendingMsg: 'âœ… Your listing is live! Everyone can see it now.',
    allMakes: 'All Makes', allYears: 'All Years',
    allPrices: 'All Prices', allCities: 'All Cities', allGears: 'All Transmissions',
    noCars: 'No listings found', noCarsDesc: 'Try changing search filters',
    sold: 'Sold', featured: 'Featured', newBadge: 'âœ¨ New',
    dir: 'ltr', lang: 'ğŸ‡¦ğŸ‡ª Ø¹Ø±Ø¨ÙŠ', addCar: 'Post Car',
    km: 'km', contact: 'Contact', whatsapp: 'WhatsApp', call: 'Call',
    year: 'Year', price: 'Price', hand: 'Hand', gear: 'Gear', fuel: 'Fuel', color: 'Color',
    seller: 'Seller', city: 'City', description: 'Description',
    searchBtn: 'Search', mileage: 'km'
  }
};

function t(key) { return T[currentLang]?.[key] || T.he[key] || key; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LANGUAGE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function cycleLang() {
  const langs = ['he','ar','en'];
  const idx = langs.indexOf(currentLang);
  currentLang = langs[(idx+1) % langs.length];
  applyLang();
}

function applyLang() {
  const L = T[currentLang];
  document.documentElement.lang = currentLang;
  document.documentElement.dir = L.dir;
  document.getElementById('langBtn').textContent = L.lang;
  document.getElementById('heroBadgeText').textContent = L.heroBadge;
  document.getElementById('heroTitle').innerHTML = L.heroTitle;
  document.getElementById('heroSub').textContent = L.heroSub;
  document.getElementById('heroAddBtn').textContent = L.heroAdd;
  document.getElementById('heroBrowseBtn').textContent = L.heroBrowse;
  document.getElementById('statCarsLabel').textContent = L.statCarsLabel;
  document.getElementById('statFollowers').textContent = L.statFollowers;
  document.getElementById('statFree').textContent = L.statFree;
  document.getElementById('sectionTitle').innerHTML = L.sectionTitle;
  document.getElementById('addModalTitle').textContent = L.addModalTitle;
  document.getElementById('submitBtn').textContent = L.submitBtn;
  document.getElementById('uploadText').innerHTML = L.uploadText;
  document.getElementById('searchBtnEl').textContent = L.searchBtn;
  document.getElementById('filterMake').options[0].text = L.allMakes;
  document.getElementById('filterYear').options[0].text = L.allYears;
  document.getElementById('filterMaxPrice').options[0].text = L.allPrices;
  document.getElementById('filterCity').options[0].text = L.allCities;
  document.getElementById('filterGear').options[0].text = L.allGears;
  renderCars(filteredCars);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOAD CARS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function loadCars() {
  document.getElementById('carsContainer').innerHTML = `
    <div class="loading">
      <div class="spinner"></div>
      <p style="color:var(--text2);font-weight:600">×˜×•×¢×Ÿ ××•×“×¢×•×ª...</p>
    </div>`;

  try {
    const query = isAdmin
      ? sb.from('cars').select('*').order('created_at', { ascending: false })
      : sb.from('cars').select('*').eq('status', 'active').order('created_at', { ascending: false });

    const { data, error } = await query;
    if (error) throw error;

    allCars = data || [];
    filteredCars = [...allCars];
    populateFilters();
    sortCars(currentSort);
    const activeCount = allCars.filter(c => c.status === 'active').length;
    document.getElementById('statCars').textContent = activeCount;
    document.getElementById('countBadge').textContent = filteredCars.length + ' ××•×“×¢×•×ª';
  } catch(e) {
    console.error(e);
    document.getElementById('carsContainer').innerHTML = `
      <div class="empty-state">
        <div class="empty-icon">âš ï¸</div>
        <h3>×©×’×™××” ×‘×˜×¢×™× ×”</h3>
        <p>${e.message}</p>
        <button class="btn btn-red" style="margin-top:16px" onclick="loadCars()">× ×¡×” ×©×•×‘</button>
      </div>`;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// POPULATE FILTERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function populateFilters() {
  const makes = [...new Set(allCars.map(c => c.make).filter(Boolean))].sort();
  const years = [...new Set(allCars.map(c => c.year).filter(Boolean))].sort((a,b)=>b-a);
  const cities = [...new Set(allCars.map(c => c.seller_city).filter(Boolean))].sort();

  const makeEl = document.getElementById('filterMake');
  const yearEl = document.getElementById('filterYear');
  const cityEl = document.getElementById('filterCity');

  // Save current values
  const curMake = makeEl.value, curYear = yearEl.value, curCity = cityEl.value;

  // Reset and repopulate
  while(makeEl.options.length > 1) makeEl.remove(1);
  while(yearEl.options.length > 1) yearEl.remove(1);
  while(cityEl.options.length > 1) cityEl.remove(1);

  makes.forEach(m => makeEl.add(new Option(m, m)));
  years.forEach(y => yearEl.add(new Option(y, y)));
  cities.forEach(c => cityEl.add(new Option(c, c)));

  makeEl.value = curMake; yearEl.value = curYear; cityEl.value = curCity;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FILTER & SORT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function filterCars() {
  const text = document.getElementById('searchText').value.toLowerCase();
  const make = document.getElementById('filterMake').value;
  const year = document.getElementById('filterYear').value;
  const maxPrice = document.getElementById('filterMaxPrice').value;
  const city = document.getElementById('filterCity').value;
  const gear = document.getElementById('filterGear').value;
  const fuel = document.getElementById('filterFuel').value;

  filteredCars = allCars.filter(car => {
    if (text && !`${car.make} ${car.model} ${car.seller_city} ${car.color}`.toLowerCase().includes(text)) return false;
    if (make && car.make !== make) return false;
    if (year && car.year != year) return false;
    if (maxPrice && car.price > parseInt(maxPrice)) return false;
    if (city && car.seller_city !== city) return false;
    if (gear && car.gear_type !== gear) return false;
    if (fuel && car.fuel_type !== fuel) return false;
    return true;
  });

  sortCars(currentSort);
}

function sortCars(type, btn) {
  currentSort = type;

  // Update button styles
  if (btn) {
    document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
  }

  const sorted = [...filteredCars];
  if (type === 'price_asc') sorted.sort((a,b) => a.price - b.price);
  else if (type === 'price_desc') sorted.sort((a,b) => b.price - a.price);
  else if (type === 'km_asc') sorted.sort((a,b) => (a.mileage||999999) - (b.mileage||999999));
  else sorted.sort((a,b) => new Date(b.created_at) - new Date(a.created_at));

  renderCars(sorted);
  document.getElementById('countBadge').textContent = filteredCars.length + ' ××•×“×¢×•×ª';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER CARS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderCars(cars) {
  const container = document.getElementById('carsContainer');

  if (!cars.length) {
    container.innerHTML = `
      <div class="empty-state">
        <div class="empty-icon">ğŸ”</div>
        <h3>${t('noCars')}</h3>
        <p>${t('noCarsDesc')}</p>
      </div>`;
    return;
  }

  container.innerHTML = `<div class="cars-grid">${cars.map(car => carCard(car)).join('')}</div>`;
}

function carCard(car) {
  const imgs = car.images || [];
  const img = car.main_image || imgs[0];
  const imgHtml = img
    ? `<img class="car-img" src="${img}" alt="${car.make} ${car.model}" loading="lazy" onerror="this.style.display='none';this.parentElement.querySelector('.car-img-placeholder').style.display='flex'">`
    : '';
  const placeholderHtml = `<div class="car-img-placeholder" style="${img ? 'display:none' : ''}">ğŸš—</div>`;

  const badges = [];
  if (car.featured) badges.push(`<span class="badge badge-featured">â­ ${t('featured')}</span>`);
  if (car.status === 'sold') badges.push(`<span class="badge badge-sold">âœ“ ${t('sold')}</span>`);
  const isNew = (Date.now() - new Date(car.created_at)) < 86400000 * 3;
  if (isNew && car.status !== 'sold') badges.push(`<span class="badge badge-new">${t('newBadge')}</span>`);

  const adminBtns = isAdmin ? `
    <div style="padding:8px 14px;display:flex;gap:6px;border-top:1px solid var(--border)">
      ${car.status==='pending' ? `<button onclick="approveCar('${car.id}');event.stopPropagation()" style="flex:1;padding:7px;background:rgba(74,222,128,0.12);border:1px solid rgba(74,222,128,0.3);color:#4ade80;border-radius:9px;cursor:pointer;font-size:12px;font-weight:800;font-family:var(--font)">âœ“ ××©×¨ ×¤×¨×¡×•×</button>` : ''}
      ${car.status==='active' ? `<button onclick="markSold('${car.id}');event.stopPropagation()" style="flex:1;padding:7px;background:rgba(212,175,55,0.12);border:1px solid rgba(212,175,55,0.3);color:var(--gold);border-radius:9px;cursor:pointer;font-size:12px;font-weight:800;font-family:var(--font)">× ××›×¨</button>` : ''}
      <button onclick="deleteCar('${car.id}');event.stopPropagation()" style="padding:7px 13px;background:rgba(239,68,68,0.12);border:1px solid rgba(239,68,68,0.3);color:#ef4444;border-radius:9px;cursor:pointer;font-size:12px;font-weight:800;font-family:var(--font)">âœ•</button>
    </div>` : '';

  const pendingBar = car.status === 'pending' && isAdmin
    ? `<div class="status-pending-bar">â³ ×××ª×™×Ÿ ×œ××™×©×•×¨</div>` : '';

  const imgCountHtml = imgs.length > 1
    ? `<div class="car-img-count">ğŸ“· ${imgs.length}</div>` : '';

  return `
    <div class="car-card" onclick="openDetail('${car.id}')">
      <div class="car-img-wrap">
        ${placeholderHtml}${imgHtml}
        <div class="car-badges">${badges.join('')}</div>
        ${imgCountHtml}
      </div>
      ${pendingBar}
      <div class="car-body">
        <div class="car-title">${car.make} ${car.model}</div>
        <div class="car-sub">${car.year} â€¢ ${car.seller_city}</div>
        <div class="car-price-row">
          <div class="car-price">â‚ª${Number(car.price).toLocaleString()}</div>
        </div>
        <div class="car-specs">
          <span class="spec-tag">ğŸ”„ ${car.gear_type || '××•×˜×•××˜'}</span>
          <span class="spec-tag">â›½ ${car.fuel_type || '×‘× ×–×™×Ÿ'}</span>
          ${car.mileage ? `<span class="spec-tag">ğŸ“ ${Number(car.mileage).toLocaleString()} ${t('km')}</span>` : ''}
          ${car.hand ? `<span class="spec-tag">âœ‹ ×™×“ ${car.hand}</span>` : ''}
        </div>
        <div class="car-footer">
          <span class="car-city">ğŸ“ ${car.seller_city}</span>
          <div class="car-contact" onclick="event.stopPropagation()">
            <a class="wa-btn" href="https://wa.me/972${(car.seller_phone||'').replace(/\D/g,'').replace(/^0/,'')}" target="_blank" title="WhatsApp">ğŸ’¬</a>
            <a class="call-btn" href="tel:${car.seller_phone}" title="${t('call')}">ğŸ“</a>
          </div>
        </div>
      </div>
      ${adminBtns}
    </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CAR DETAIL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openDetail(id) {
  const car = allCars.find(c => c.id === id);
  if (!car) return;

  const imgs = car.images && car.images.length ? car.images : (car.main_image ? [car.main_image] : []);
  const mainImg = imgs[0] || null;

  const galleryHtml = mainImg ? `
    <div class="detail-gallery">
      <img class="detail-img-main" id="mainDetailImg" src="${mainImg}" alt="${car.make} ${car.model}">
      ${imgs.length > 1 ? `
        <div class="detail-thumbs">
          ${imgs.map((src, i) => `<img class="detail-thumb ${i===0?'active':''}" src="${src}" onclick="switchDetailImg('${src}',this)" loading="lazy">`).join('')}
        </div>` : ''}
    </div>` : '';

  const desc = car.description_he || car.description_ar || '';
  const descHtml = desc ? `
    <div class="detail-desc">${desc}</div>` : '';

  document.getElementById('detailTitle').textContent = `${car.make} ${car.model} ${car.year}`;
  document.getElementById('detailBody').innerHTML = `
    ${galleryHtml}
    <div class="detail-header-row">
      <div class="detail-title-group">
        <div class="detail-car-name">${car.make} ${car.model}</div>
        <div class="detail-car-sub">${car.year} â€¢ ×™×“ ${car.hand || 'â€”'} â€¢ ${car.seller_city}</div>
      </div>
      <div>
        <div class="detail-price">â‚ª${Number(car.price).toLocaleString()}</div>
        <div class="detail-price-label">××—×™×¨ ××‘×•×§×©</div>
      </div>
    </div>
    <div class="detail-specs">
      ${car.mileage ? `<div class="detail-spec"><div class="detail-spec-val">ğŸ“ ${Number(car.mileage).toLocaleString()}</div><div class="detail-spec-key">${t('km')}</div></div>` : ''}
      <div class="detail-spec"><div class="detail-spec-val">ğŸ”„ ${car.gear_type||'â€”'}</div><div class="detail-spec-key">${t('gear')}</div></div>
      <div class="detail-spec"><div class="detail-spec-val">â›½ ${car.fuel_type||'â€”'}</div><div class="detail-spec-key">${t('fuel')}</div></div>
      ${car.color ? `<div class="detail-spec"><div class="detail-spec-val">ğŸ¨ ${car.color}</div><div class="detail-spec-key">${t('color')}</div></div>` : ''}
      ${car.engine_size ? `<div class="detail-spec"><div class="detail-spec-val">ğŸ”§ ${car.engine_size}L</div><div class="detail-spec-key">×× ×•×¢</div></div>` : ''}
      <div class="detail-spec"><div class="detail-spec-val">âœ‹ ×™×“ ${car.hand||'â€”'}</div><div class="detail-spec-key">${t('hand')}</div></div>
    </div>
    ${descHtml}
    <div class="seller-card">
      <div class="seller-avatar">ğŸ‘¤</div>
      <div>
        <div class="seller-name">${car.seller_name || 'â€”'}</div>
        <div class="seller-city">ğŸ“ ${car.seller_city || 'â€”'}</div>
      </div>
    </div>
    <div class="contact-bar">
      <a class="contact-wa" href="https://wa.me/972${(car.seller_phone||'').replace(/\D/g,'').replace(/^0/,'')}" target="_blank">
        ğŸ’¬ ${t('whatsapp')}
      </a>
      <a class="contact-call" href="tel:${car.seller_phone}">
        ğŸ“ ${t('call')} â€” ${car.seller_phone}
      </a>
    </div>
    ${isAdmin ? `
      <div style="display:flex;gap:8px;margin-top:12px">
        ${car.status==='pending' ? `<button onclick="approveCar('${car.id}');closeDetailModal()" style="flex:1;padding:12px;background:rgba(74,222,128,0.12);border:1px solid rgba(74,222,128,0.3);color:#4ade80;border-radius:12px;cursor:pointer;font-size:14px;font-weight:800;font-family:var(--font)">âœ“ ××©×¨ ×¤×¨×¡×•×</button>` : ''}
        <button onclick="deleteCar('${car.id}');closeDetailModal()" style="flex:1;padding:12px;background:rgba(239,68,68,0.12);border:1px solid rgba(239,68,68,0.3);color:#ef4444;border-radius:12px;cursor:pointer;font-size:14px;font-weight:800;font-family:var(--font)">ğŸ—‘ ××—×§ ××•×“×¢×”</button>
      </div>` : ''}`;

  document.getElementById('detailModal').classList.add('open');
}

function switchDetailImg(src, el) {
  document.getElementById('mainDetailImg').src = src;
  document.querySelectorAll('.detail-thumb').forEach(t => t.classList.remove('active'));
  el.classList.add('active');
}

function closeDetailModal() {
  document.getElementById('detailModal').classList.remove('open');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ADD CAR MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openAddModal() {
  document.getElementById('addModal').classList.add('open');
  document.getElementById('addCarForm').reset();
  document.getElementById('previewGrid').innerHTML = '';
  uploadedImages = [];
}

function closeAddModal() {
  document.getElementById('addModal').classList.remove('open');
}

function handleModalClick(e, id) {
  if (e.target.id === id) {
    if (id === 'addModal') closeAddModal();
    if (id === 'detailModal') closeDetailModal();
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// IMAGE HANDLING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function handleImages(input) {
  const files = [...input.files].slice(0, 10);
  uploadedImages = files;
  const preview = document.getElementById('previewGrid');
  preview.innerHTML = '';
  files.forEach((f, idx) => {
    const reader = new FileReader();
    reader.onload = e => {
      const wrap = document.createElement('div');
      wrap.className = 'preview-wrap';
      wrap.innerHTML = `
        <img src="${e.target.result}" class="preview-img">
        <button class="preview-remove" onclick="removeImage(${idx})" type="button">Ã—</button>`;
      preview.appendChild(wrap);
    };
    reader.readAsDataURL(f);
  });
}

function removeImage(idx) {
  uploadedImages.splice(idx, 1);
  const newDt = new DataTransfer();
  uploadedImages.forEach(f => newDt.items.add(f));
  document.getElementById('imgInput').files = newDt.files;
  handleImages(document.getElementById('imgInput'));
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UPLOAD IMAGE TO CLOUDINARY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function uploadToCloudinary(file, progressCallback) {
  // ×× Cloudinary ×œ× ××•×’×“×¨, ×”×©×ª××© ×‘-Supabase Storage
  if (CLOUDINARY_CLOUD_NAME === 'YOUR_CLOUD_NAME') {
    return await uploadToSupabase(file);
  }

  const formData = new FormData();
  formData.append('file', file);
  formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);
  formData.append('folder', 'yougo-cars');

  const res = await fetch(`https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`, {
    method: 'POST',
    body: formData
  });

  if (!res.ok) throw new Error('Cloudinary upload failed');
  const data = await res.json();
  return data.secure_url;
}

async function uploadToSupabase(file) {
  const ext = file.name.split('.').pop();
  const path = `${Date.now()}-${Math.random().toString(36).slice(2)}.${ext}`;
  const { data, error } = await sb.storage.from('car-images').upload(path, file, {
    cacheControl: '3600', upsert: false
  });
  if (error) throw error;
  const { data: urlData } = sb.storage.from('car-images').getPublicUrl(path);
  return urlData.publicUrl;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SUBMIT CAR â€” ×¤×¨×¡×•× ××™×™×“×™!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function submitCar(e) {
  e.preventDefault();
  const btn = document.getElementById('submitBtn');
  const progressEl = document.getElementById('uploadProgress');
  const progressBar = document.getElementById('uploadProgressBar');

  btn.disabled = true;
  btn.textContent = 'â³ ××¢×œ×” ×ª××•× ×•×ª...';

  if (uploadedImages.length > 0) {
    progressEl.style.display = 'block';
  }

  try {
    // Upload images
    const imageUrls = [];
    for (let i = 0; i < uploadedImages.length; i++) {
      const file = uploadedImages[i];
      btn.textContent = `â³ ××¢×œ×” ×ª××•× ×” ${i+1}/${uploadedImages.length}...`;
      progressBar.style.width = `${((i+1)/uploadedImages.length)*100}%`;

      const url = await uploadToCloudinary(file);
      imageUrls.push(url);
    }

    progressEl.style.display = 'none';
    btn.textContent = 'ğŸ’¾ ×©×•××¨ ××•×“×¢×”...';

    // âš¡ ×¤×¨×¡×•× ××™×™×“×™ â€” status: 'active'
    const carData = {
      make: document.getElementById('f_make').value.trim(),
      model: document.getElementById('f_model').value.trim(),
      year: parseInt(document.getElementById('f_year').value),
      price: parseInt(document.getElementById('f_price').value),
      mileage: parseInt(document.getElementById('f_mileage').value) || 0,
      hand: parseInt(document.getElementById('f_hand').value),
      gear_type: document.getElementById('f_gear').value,
      fuel_type: document.getElementById('f_fuel').value,
      color: document.getElementById('f_color').value.trim(),
      engine_size: parseFloat(document.getElementById('f_engine').value) || null,
      description_he: document.getElementById('f_desc_he').value,
      description_ar: document.getElementById('f_desc_ar').value,
      seller_name: document.getElementById('f_name').value.trim(),
      seller_phone: document.getElementById('f_phone').value.trim(),
      seller_city: document.getElementById('f_city').value.trim(),
      images: imageUrls,
      main_image: imageUrls[0] || null,
      status: 'active', // â† ×¤×¨×¡×•× ××™×™×“×™ ×ª××™×“!
    };

    const { error } = await sb.from('cars').insert(carData);
    if (error) throw error;

    // Reload cars to show the new listing
    await loadCars();

    // Show success
    document.getElementById('addModalBody').innerHTML = `
      <div class="success-msg">
        <div class="success-icon">ğŸ‰</div>
        <h3>×”××•×“×¢×” ×¤×•×¨×¡××”!</h3>
        <p>×”×¨×›×‘ ×©×œ×š ×–××™×Ÿ ×¢×›×©×™×• ×œ×›×•×œ× ×œ×¨××•×ª ğŸš—âœ¨</p>
        <button class="btn btn-red" style="margin-top:24px;padding:14px 36px;font-size:16px" onclick="closeAddModal();document.getElementById('addModalBody').innerHTML=''">
          ×¡×’×•×¨
        </button>
      </div>`;

    showToast('ğŸš— ×”××•×“×¢×” ×¤×•×¨×¡××” ×‘×”×¦×œ×—×”!', 'success');

  } catch(err) {
    showToast('âŒ ×©×’×™××”: ' + err.message, 'error');
    btn.disabled = false;
    btn.textContent = t('submitBtn');
    progressEl.style.display = 'none';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ADMIN FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function adminLogin() {
  const pass = prompt('ğŸ”‘ Admin Password:');
  if (pass === null) return;

  if (pass === ADMIN_PASS) {
    isAdmin = true;
    const bar = document.getElementById('adminBar');
    bar.style.display = 'flex';
    document.getElementById('heroSection').style.marginTop = '0';
    document.getElementById('adminActions').innerHTML = `
      <span style="color:var(--text2);font-size:13px;font-weight:600">××¦×‘ ××“××™×Ÿ ×¤×¢×™×œ</span>
      <button onclick="loadCars()" style="background:rgba(200,16,46,0.12);border:1px solid var(--border-red);color:var(--red);padding:7px 16px;border-radius:9px;cursor:pointer;font-size:13px;font-weight:800;font-family:var(--font)">ğŸ”„ ×¨×¢× ×Ÿ</button>
      <a href="admin.html" style="background:rgba(59,130,246,0.12);border:1px solid rgba(59,130,246,0.3);color:#60a5fa;padding:7px 16px;border-radius:9px;cursor:pointer;font-size:13px;font-weight:800;font-family:var(--font);text-decoration:none">âš™ï¸ ×œ×•×— × ×™×”×•×œ</a>
      <button onclick="adminLogout()" style="background:var(--bg3);border:1px solid var(--border);color:var(--text2);padding:7px 16px;border-radius:9px;cursor:pointer;font-size:13px;font-family:var(--font);font-weight:700">×™×¦×™××”</button>`;
    loadCars();
    showToast('âœ… ×‘×¨×•×š ×”×‘×, Admin!', 'success');
  } else {
    showToast('âŒ ×¡×™×¡××” ×©×’×•×™×”', 'error');
  }
}

function adminLogout() {
  isAdmin = false;
  document.getElementById('adminBar').style.display = 'none';
  document.getElementById('heroSection').style.marginTop = '';
  loadCars();
}

async function approveCar(id) {
  const { error } = await sb.from('cars').update({ status: 'active' }).eq('id', id);
  if (!error) { showToast('âœ… ×”××•×“×¢×” ××•×©×¨×”!', 'success'); loadCars(); }
  else showToast('âŒ ×©×’×™××”: ' + error.message, 'error');
}

async function markSold(id) {
  const { error } = await sb.from('cars').update({ status: 'sold' }).eq('id', id);
  if (!error) { showToast('âœ… ×¡×•××Ÿ ×›× ××›×¨', 'success'); loadCars(); }
}

async function deleteCar(id) {
  if (!confirm('×œ××—×•×§ ××•×“×¢×” ×–×• ×œ×¦××™×ª×•×ª?')) return;
  const { error } = await sb.from('cars').delete().eq('id', id);
  if (!error) { showToast('ğŸ—‘ï¸ ×”××•×“×¢×” × ××—×§×”', 'success'); loadCars(); }
  else showToast('âŒ ×©×’×™××”: ' + error.message, 'error');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UTILS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showToast(msg, type = 'success') {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.className = `toast ${type} show`;
  setTimeout(() => el.classList.remove('show'), 3500);
}

function scrollToListings() {
  document.getElementById('listingsSection').scrollIntoView({ behavior: 'smooth' });
}

function showHome() {
  filteredCars = [...allCars];
  sortCars(currentSort);
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// ESC to close modals
document.addEventListener('keydown', e => {
  if (e.key === 'Escape') { closeDetailModal(); closeAddModal(); }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
loadCars();
</script>
</body>
</html>
