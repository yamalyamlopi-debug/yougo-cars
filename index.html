<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="theme-color" content="#07070e">
<title>YOUGO CARS â€” ×©×•×§ ×”×¨×›×‘×™× ×”×“×™×’×™×˜×œ×™</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
/* â”€â”€ TOKENS â”€â”€ */
:root{
  --red:#e8112e; --red2:#b50d24;
  --bg:#0a0a12; --bg2:#0f0f1e; --bg3:#141428;
  --card:#121224; --card2:#181832;
  --b0:rgba(255,255,255,.10); --b1:rgba(255,255,255,.20);
  --bred:rgba(232,17,46,.35); --bred2:rgba(232,17,46,.6);
  --t0:#ffffff;
  --t1:rgba(255,255,255,.78);
  --t2:rgba(255,255,255,.48);
  --gold:#f0c84a;
  --r:16px; --r2:22px; --r3:28px;
  --nav:62px;
  --ease:cubic-bezier(.4,0,.2,1);
  --font:'Heebo',system-ui,sans-serif;
}
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth;-webkit-text-size-adjust:100%}
body{font-family:var(--font);background:var(--bg);color:#ffffff;overflow-x:hidden;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
img{display:block;max-width:100%}
a{color:inherit;text-decoration:none}
::-webkit-scrollbar{width:3px}
::-webkit-scrollbar-thumb{background:var(--red);border-radius:2px}

body::before{
  content:'';position:fixed;inset:0;z-index:0;pointer-events:none;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.035'/%3E%3C/svg%3E");
  background-repeat:repeat;background-size:200px 200px;opacity:.4;mix-blend-mode:overlay;
}

/* â”€â”€ NAV â”€â”€ */
#nav{
  position:fixed;top:0;left:0;right:0;z-index:500;height:var(--nav);
  padding:0 14px;
  display:flex;align-items:center;gap:8px;
  background:rgba(7,7,14,.78);backdrop-filter:blur(28px) saturate(1.8);
  border-bottom:1px solid rgba(255,255,255,.055);
  transition:background .3s var(--ease),border-color .3s var(--ease);
  overflow:hidden;
}
#nav.solid{background:rgba(7,7,14,.97);border-color:var(--b0)}

.logo{display:flex;align-items:center;gap:9px;cursor:pointer;flex-shrink:0;min-width:0}
.logo-box{
  width:36px;height:36px;min-width:36px;border-radius:10px;flex-shrink:0;
  background:linear-gradient(135deg,#c8102e,#9b0d24);
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 4px 14px rgba(200,16,46,.45);
}
.logo-text{font-size:17px;font-weight:900;letter-spacing:-.5px;white-space:nowrap;line-height:1;color:#fff}
.logo-text .r{color:#e8112e}

.nav-mid{display:flex;gap:2px;flex-shrink:0}
.nav-a{padding:6px 11px;border-radius:9px;font-size:12.5px;font-weight:700;color:var(--t1);
  cursor:pointer;background:none;border:none;font-family:var(--font);transition:all .18s;white-space:nowrap}
.nav-a:hover{color:var(--t0);background:rgba(255,255,255,.07)}

.nav-end{display:flex;gap:6px;align-items:center;margin-right:auto;flex-shrink:0}

.btn-lang{
  display:inline-flex;align-items:center;gap:6px;
  background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);
  color:var(--t0);padding:7px 12px;border-radius:10px;font-size:12px;cursor:pointer;
  font-family:var(--font);transition:all .2s var(--ease);font-weight:700;
  letter-spacing:.02em;white-space:nowrap;flex-shrink:0;
}
.btn-lang:hover{border-color:rgba(200,16,46,.5);background:rgba(200,16,46,.08);color:#fff}
.btn-lang .lang-icon{
  width:18px;height:18px;border-radius:4px;
  display:flex;align-items:center;justify-content:center;
  background:linear-gradient(135deg,var(--red),#e0162f);
  font-size:9px;font-weight:900;color:#fff;letter-spacing:0;flex-shrink:0;
}

.btn-pkg-nav{
  display:inline-flex;align-items:center;gap:5px;
  padding:8px 12px;border-radius:10px;font-size:12px;font-weight:900;
  background:rgba(212,175,55,.1);border:1.5px solid rgba(212,175,55,.35);
  color:var(--gold);cursor:pointer;font-family:var(--font);
  white-space:nowrap;text-decoration:none;flex-shrink:0;transition:all .18s;
}
.btn-pkg-nav:hover{background:rgba(212,175,55,.2);border-color:rgba(212,175,55,.6)}

.btn{display:inline-flex;align-items:center;gap:6px;padding:9px 16px;
  border-radius:11px;font-family:var(--font);font-weight:900;font-size:13px;
  cursor:pointer;border:none;transition:all .2s var(--ease);white-space:nowrap;text-decoration:none}
.btn-red{background:linear-gradient(135deg,var(--red),#e0162f);color:#fff;
  box-shadow:0 4px 16px rgba(200,16,46,.38)}
.btn-red:hover{transform:translateY(-1px);box-shadow:0 6px 22px rgba(200,16,46,.54)}

/* â”€â”€ ADMIN BAR â”€â”€ */
#adminBar{display:none;background:rgba(200,16,46,.06);border-bottom:1px solid var(--bred);
  padding:9px 22px;align-items:center;gap:10px;flex-wrap:wrap}
#adminBar.show{display:flex}

/* â”€â”€ HERO â”€â”€ */
.hero{
  position:relative;min-height:100svh;
  display:flex;align-items:center;justify-content:center;text-align:center;
  padding:calc(var(--nav) + 56px) 22px 72px;overflow:hidden;
}
.hero-bg{
  position:absolute;inset:0;z-index:0;
  background:
    radial-gradient(ellipse 120% 60% at 50% -5%,rgba(232,17,46,.42) 0%,transparent 58%),
    radial-gradient(ellipse 60% 50% at 2% 88%,rgba(232,17,46,.18) 0%,transparent 50%),
    radial-gradient(ellipse 55% 45% at 98% 85%,rgba(90,20,220,.12) 0%,transparent 50%),
    radial-gradient(ellipse 80% 40% at 50% 50%,rgba(20,10,50,.6) 0%,transparent 80%),var(--bg);
}
.hero-grid{
  position:absolute;inset:0;z-index:0;
  background-image:linear-gradient(rgba(255,255,255,.07) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,.07) 1px,transparent 1px);
  background-size:52px 52px;
  -webkit-mask-image:radial-gradient(ellipse 96% 78% at 50% 32%,#000 28%,transparent 75%);
  mask-image:radial-gradient(ellipse 96% 78% at 50% 32%,#000 28%,transparent 75%);
}
.hero-glow{
  position:absolute;top:-80px;left:50%;transform:translateX(-50%);
  width:800px;height:500px;
  background:radial-gradient(ellipse,rgba(232,17,46,.28) 0%,transparent 65%);
  filter:blur(60px);z-index:0;pointer-events:none;
}
.hero-in{position:relative;z-index:2;max-width:840px;width:100%}

.hero-badge{
  display:inline-flex;align-items:center;gap:8px;
  padding:8px 20px;border-radius:100px;margin-bottom:28px;
  background:rgba(232,17,46,.15);border:1px solid rgba(232,17,46,.45);
  animation:fu .6s ease both;box-shadow:0 0 24px rgba(232,17,46,.15);
}
.badge-dot{width:7px;height:7px;border-radius:50%;background:var(--red);
  animation:blink 2s infinite;box-shadow:0 0 10px var(--red)}
@keyframes blink{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.4;transform:scale(.7)}}
.hero-badge span{font-size:11.5px;font-weight:800;color:rgba(255,255,255,.88);text-transform:uppercase;letter-spacing:.12em}

@keyframes fu{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}

.hero h1{
  font-size:clamp(2.6rem,8vw,5.6rem);font-weight:900;line-height:1.06;
  letter-spacing:-2px;margin-bottom:22px;animation:fu .6s .1s ease both;
  color:#ffffff;text-shadow:0 2px 40px rgba(0,0,0,.9);
}
.hero h1 .r{
  color:transparent;
  background:linear-gradient(125deg,#ff5878 0%,#e8112e 55%,#ff2040 100%);
  -webkit-background-clip:text;background-clip:text;
  text-decoration:none;border:none;display:inline;
  filter:drop-shadow(0 0 20px rgba(232,17,46,.55));
}

.hero-sub{
  font-size:clamp(1rem,2vw,1.16rem);color:rgba(255,255,255,.84);
  line-height:1.75;max-width:500px;margin:0 auto 36px;
  animation:fu .6s .2s ease both;text-shadow:0 1px 12px rgba(0,0,0,.6);
}

.hero-ctas{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:48px;animation:fu .6s .3s ease both}
.hero-ctas .btn{padding:14px 30px;font-size:15px}

.btn-pkg{
  display:inline-flex;align-items:center;gap:9px;padding:13px 26px;border-radius:14px;
  background:linear-gradient(135deg,rgba(212,175,55,.14),rgba(212,175,55,.06));
  border:1.5px solid rgba(212,175,55,.45);color:var(--gold);
  font-weight:900;font-size:14px;cursor:pointer;font-family:var(--font);transition:all .22s var(--ease);text-decoration:none;
}
.btn-pkg:hover{background:linear-gradient(135deg,rgba(212,175,55,.26),rgba(212,175,55,.12));border-color:rgba(212,175,55,.75);transform:translateY(-2px);box-shadow:0 8px 28px rgba(212,175,55,.22)}
.btn-ghost{background:rgba(255,255,255,.08);border:1px solid var(--b0);color:var(--t1);font-size:15px;padding:14px 30px}
.btn-ghost:hover{background:rgba(255,255,255,.13);color:var(--t0);border-color:var(--b1)}

.hero-stats{
  display:flex;max-width:500px;margin:0 auto;
  border:1px solid rgba(255,255,255,.14);border-radius:20px;
  background:rgba(255,255,255,.06);overflow:hidden;
  box-shadow:0 8px 32px rgba(0,0,0,.4),inset 0 1px 0 rgba(255,255,255,.08);
  backdrop-filter:blur(12px);animation:fu .6s .4s ease both;
}
.hs{flex:1;padding:20px 14px;text-align:center;position:relative}
.hs:not(:last-child)::after{content:'';position:absolute;right:0;top:20%;bottom:20%;width:1px;background:rgba(255,255,255,.14)}
.hs-v{font-size:1.8rem;font-weight:900;color:#ffffff;text-shadow:0 2px 12px rgba(0,0,0,.5)}
.hs-v .a{color:var(--red)}
.hs-l{font-size:10px;color:rgba(255,255,255,.55);margin-top:3px;font-weight:700;text-transform:uppercase;letter-spacing:.08em}

/* â”€â”€ TICKER â”€â”€ */
.ticker{overflow:hidden;border-top:1px solid var(--b0);border-bottom:1px solid var(--b0);background:rgba(255,255,255,.016);height:42px;display:flex;align-items:center}
.ticker-inner{display:flex;white-space:nowrap;animation:tick 26s linear infinite}
@keyframes tick{from{transform:translateX(0)}to{transform:translateX(-50%)}}
.ti{display:flex;align-items:center;gap:8px;padding:0 26px;height:42px;font-size:12.5px;font-weight:700;color:rgba(255,255,255,.72);border-left:1px solid rgba(255,255,255,.08)}
.ti:first-child{border-left:none}

/* â”€â”€ SEARCH â”€â”€ */
.search-wrap{padding:52px 22px 0;max-width:980px;margin:0 auto}
.search-eyebrow{display:flex;align-items:center;gap:8px;margin-bottom:13px}
.search-eyebrow-line{width:28px;height:2px;border-radius:2px;background:var(--red)}
.search-eyebrow-text{font-size:10.5px;font-weight:900;color:#ff4466;text-transform:uppercase;letter-spacing:.14em}

.search-card{
  background:linear-gradient(160deg,#181832,#0f0f1e);
  border:1.5px solid rgba(255,255,255,.16);border-radius:22px;overflow:hidden;
  box-shadow:0 6px 40px rgba(0,0,0,.55),0 0 0 1px rgba(200,16,46,.07);transition:border-color .22s,box-shadow .22s;
}
.search-card:focus-within{border-color:rgba(200,16,46,.48);box-shadow:0 6px 40px rgba(0,0,0,.55),0 0 0 4px rgba(200,16,46,.07)}

.search-main{display:flex;align-items:center;padding:7px 7px 7px 18px;border-bottom:1px solid rgba(255,255,255,.10);gap:10px}
.search-ico{font-size:17px;color:var(--t2);flex-shrink:0}
.search-input{flex:1;background:none;border:none;outline:none;font-size:15px;font-weight:600;color:var(--t0);font-family:var(--font);padding:10px 4px;min-width:0}
.search-input::placeholder{color:rgba(255,255,255,.38)}
.search-go{padding:11px 28px;border-radius:14px;border:none;background:linear-gradient(135deg,var(--red),#e0162f);color:#fff;font-family:var(--font);font-size:14px;font-weight:900;cursor:pointer;transition:all .2s var(--ease);flex-shrink:0;box-shadow:0 4px 14px rgba(200,16,46,.4)}
.search-go:hover{transform:translateY(-1px);box-shadow:0 6px 22px rgba(200,16,46,.56)}

.filter-strip{display:flex;gap:4px;padding:6px 8px;overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none}
.filter-strip::-webkit-scrollbar{display:none}
.fc{
  display:flex;align-items:center;gap:5px;padding:8px 14px;border-radius:10px;cursor:pointer;
  background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);
  color:rgba(255,255,255,.78);font-size:12.5px;font-weight:700;white-space:nowrap;font-family:var(--font);
  transition:all .18s;flex-shrink:0;appearance:none;-webkit-appearance:none;outline:none;
}
.fc:hover,.fc:focus{border-color:rgba(200,16,46,.38);color:var(--t0);background:rgba(200,16,46,.07)}
.fc option{background:#101022}

/* â”€â”€ LISTINGS â”€â”€ */
.main{max-width:1240px;margin:0 auto;padding:42px 20px 100px}
.list-head{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;margin-bottom:22px}
.list-title{font-size:1.5rem;font-weight:900;color:#ffffff}
.list-title .r{color:var(--red)}
.cnt-badge{padding:5px 14px;border-radius:100px;font-size:12px;font-weight:800;background:rgba(200,16,46,.1);border:1px solid rgba(200,16,46,.2);color:var(--red)}
.sort-row{display:flex;gap:6px;margin-bottom:24px;flex-wrap:wrap}
.sort-btn{padding:7px 15px;border-radius:9px;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.05);color:rgba(255,255,255,.75);font-family:var(--font);font-size:12px;font-weight:700;cursor:pointer;transition:all .18s;white-space:nowrap}
.sort-btn:hover{color:var(--t0);border-color:var(--b1)}
.sort-btn.on{background:rgba(200,16,46,.1);border-color:var(--bred);color:var(--red)}

/* â”€â”€ CARS GRID â”€â”€ */
.cars-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:18px;padding-top:8px}

/* â”€â”€ CAR CARD â”€â”€ */
.car-card{
  background:#0f0f1d;border:1px solid rgba(255,255,255,.09);border-radius:20px;
  overflow:visible;cursor:pointer;display:flex;flex-direction:column;position:relative;
  transition:all .3s cubic-bezier(.25,.46,.45,.94);
  box-shadow:0 2px 16px rgba(0,0,0,.5);
  margin-top:18px; /* space for peek */
}
.car-card::before{content:'';position:absolute;inset:0;border-radius:20px;background:linear-gradient(135deg,rgba(232,17,46,.04) 0%,transparent 60%);opacity:0;transition:opacity .3s;pointer-events:none;z-index:1}
.car-card:hover{transform:translateY(-4px);border-color:rgba(232,17,46,.5);box-shadow:0 20px 56px rgba(0,0,0,.7),0 0 0 1px rgba(232,17,46,.2)}
.car-card:hover::before{opacity:1}

/* Floating image peek above card */
.car-img-outer{
  position:relative;
  margin:-18px 10px 0;
  z-index:2;
  border-radius:14px;
  overflow:hidden;
  box-shadow:0 10px 36px rgba(0,0,0,.65);
  flex-shrink:0;
  transition:transform .3s cubic-bezier(.25,.46,.45,.94),box-shadow .3s;
}
.car-card:hover .car-img-outer{
  transform:translateY(-5px);
  box-shadow:0 18px 52px rgba(0,0,0,.8),0 0 0 1.5px rgba(232,17,46,.3);
}

.car-img-wrap{position:relative;overflow:hidden;aspect-ratio:4/3.2;background:#0a0a18;flex-shrink:0}
.car-img{width:100%;height:100%;object-fit:cover;display:block;transition:transform .5s cubic-bezier(.25,.46,.45,.94)}
.car-card:hover .car-img{transform:scale(1.08)}
.car-placeholder{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px;background:linear-gradient(135deg,#0f0f22,#0a0a18)}

.car-img-wrap::after{content:'';position:absolute;bottom:0;left:0;right:0;height:55%;background:linear-gradient(to top,rgba(10,10,24,.92),transparent);pointer-events:none;z-index:1}

.car-price-float{position:absolute;bottom:12px;right:14px;z-index:2;font-size:22px;font-weight:900;color:#fff;text-shadow:0 2px 8px rgba(0,0,0,.8);letter-spacing:-.5px}
.car-price-float small{font-size:12px;font-weight:700;color:rgba(255,255,255,.7);margin-right:2px}

.car-badges{position:absolute;top:10px;right:10px;z-index:2;display:flex;flex-direction:column;gap:5px;align-items:flex-end}
.cbadge{padding:4px 10px;border-radius:100px;font-size:9.5px;font-weight:900;backdrop-filter:blur(12px);letter-spacing:.04em}
.cb-feat{background:rgba(240,200,74,.9);color:#000}
.cb-sold{background:rgba(239,68,68,.9);color:#fff}
.cb-new{background:linear-gradient(135deg,#e8112e,#c8102e);color:#fff;box-shadow:0 2px 10px rgba(232,17,46,.5)}
.car-cnt{position:absolute;bottom:10px;left:12px;z-index:2;display:flex;align-items:center;gap:4px;padding:4px 9px;border-radius:100px;font-size:10px;font-weight:800;background:rgba(0,0,0,.7);color:rgba(255,255,255,.9);backdrop-filter:blur(8px)}
.pend-bar{background:linear-gradient(90deg,rgba(234,179,8,.15),rgba(234,179,8,.08));border-bottom:1px solid rgba(234,179,8,.2);color:#fbbf24;font-size:10.5px;font-weight:800;padding:7px 14px;text-align:center}

.car-body{padding:14px 16px 12px;display:flex;flex-direction:column;gap:8px;flex:1}
.car-name{font-size:16px;font-weight:900;line-height:1.25;color:#fff;letter-spacing:-.2px}
.car-meta{font-size:11.5px;color:rgba(255,255,255,.55);font-weight:600;display:flex;align-items:center;gap:6px}
.car-meta-dot{width:3px;height:3px;border-radius:50%;background:rgba(255,255,255,.3)}

.specs{display:flex;flex-wrap:wrap;gap:5px}
.spec{padding:4px 10px;border-radius:8px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.10);font-size:10.5px;font-weight:700;color:rgba(255,255,255,.75);display:flex;align-items:center;gap:4px}
.spec-icon{font-size:11px;opacity:.7}

.car-foot{display:flex;align-items:center;justify-content:space-between;padding:10px 16px 13px;border-top:1px solid rgba(255,255,255,.07)}
.car-loc{font-size:11px;color:rgba(255,255,255,.42);font-weight:600;display:flex;align-items:center;gap:4px}
.car-acts{display:flex;gap:6px}
.act{width:34px;height:34px;border-radius:9px;display:flex;align-items:center;justify-content:center;font-size:15px;transition:all .2s;border:1px solid rgba(255,255,255,.1);text-decoration:none}
.act-wa{background:rgba(37,211,102,.08);color:#25d366}
.act-wa:hover{background:rgba(37,211,102,.2);transform:scale(1.1);border-color:rgba(37,211,102,.3)}
.act-call{background:rgba(59,130,246,.08);color:#60a5fa}
.act-call:hover{background:rgba(59,130,246,.2);transform:scale(1.1);border-color:rgba(59,130,246,.3)}

.admin-row{padding:8px 12px;display:flex;gap:6px;border-top:1px solid var(--b0)}
.a-btn{flex:1;padding:7px;border-radius:8px;font-size:11.5px;font-weight:900;cursor:pointer;border:none;font-family:var(--font);transition:all .15s}
.a-approve{background:rgba(74,222,128,.1);border:1px solid rgba(74,222,128,.28);color:#4ade80}
.a-sold{background:rgba(212,175,55,.1);border:1px solid rgba(212,175,55,.28);color:var(--gold)}
.a-del{flex:0;padding:7px 11px;background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.28);color:#ef4444}

/* Loading / empty */
.loading-box{grid-column:1/-1;padding:80px;display:flex;flex-direction:column;align-items:center;gap:14px}
.spin{width:36px;height:36px;border-radius:50%;border:3px solid rgba(255,255,255,.07);border-top-color:var(--red);animation:sp .75s linear infinite}
@keyframes sp{to{transform:rotate(360deg)}}
.empty-box{grid-column:1/-1;padding:80px 20px;text-align:center}
.empty-ico{font-size:52px;opacity:.24;margin-bottom:14px}
.empty-box h3{font-size:1.3rem;font-weight:900;margin-bottom:8px}
.empty-box p{color:var(--t1)}

/* â”€â”€ DB Error Banner â”€â”€ */
.db-error-banner{
  grid-column:1/-1;
  background:rgba(239,68,68,.08);
  border:1px solid rgba(239,68,68,.3);
  border-radius:16px;padding:24px 20px;text-align:center;
}
.db-error-banner h3{color:#ef4444;font-size:1.1rem;font-weight:900;margin-bottom:8px}
.db-error-banner p{color:rgba(255,255,255,.7);font-size:13px;margin-bottom:6px;line-height:1.6}
.db-error-banner code{display:inline-block;background:rgba(0,0,0,.4);color:#fbbf24;padding:2px 8px;border-radius:6px;font-size:11px;margin-top:6px}

/* Empty state â€” better */
.empty-state{
  grid-column:1/-1;padding:60px 20px;text-align:center;
}
.empty-state-icon{font-size:56px;margin-bottom:16px;opacity:.35}
.empty-state h3{font-size:1.25rem;font-weight:900;margin-bottom:10px;color:#fff}
.empty-state p{color:rgba(255,255,255,.55);font-size:14px;margin-bottom:24px}

/* â”€â”€ FOOTER â”€â”€ */
footer{border-top:1px solid rgba(255,255,255,.12);padding:36px 20px;background:rgba(255,255,255,.02)}
.foot-in{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px}
.foot-brand{display:flex;align-items:center;gap:9px}
.foot-box{width:32px;height:32px;border-radius:9px;background:linear-gradient(135deg,var(--red),var(--red2));display:flex;align-items:center;justify-content:center}
.foot-name{font-size:14px;font-weight:900}
.foot-name .r{color:var(--red)}
.foot-copy{font-size:11.5px;color:rgba(255,255,255,.52);font-weight:600}
.foot-links{display:flex;gap:6px;align-items:center;flex-wrap:wrap}
.foot-link{padding:5px 11px;border-radius:7px;font-size:11.5px;font-weight:700;color:rgba(255,255,255,.6);background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);transition:all .15s}
.foot-link:hover{color:#fff;border-color:rgba(255,255,255,.28)}
.foot-dot{cursor:pointer;opacity:.1;transition:opacity .2s;font-size:16px;color:var(--red);user-select:none}
.foot-dot:hover{opacity:.4}

/* â”€â”€ MODALS â”€â”€ */
.overlay{position:fixed;inset:0;z-index:600;background:rgba(0,0,0,0);backdrop-filter:blur(0);display:flex;align-items:flex-end;justify-content:center;pointer-events:none;transition:all .3s var(--ease)}
.overlay.open{background:rgba(0,0,0,.86);backdrop-filter:blur(20px);pointer-events:all;align-items:center}
.modal{background:var(--bg2);border:1px solid var(--b0);border-radius:var(--r3);width:100%;max-width:680px;max-height:92svh;overflow:hidden;display:flex;flex-direction:column;transform:translateY(30px) scale(.97);opacity:0;transition:all .3s var(--ease)}
.overlay.open .modal{transform:translateY(0) scale(1);opacity:1}
.modal-head{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid var(--b0);background:rgba(7,7,14,.9);backdrop-filter:blur(12px);flex-shrink:0;position:sticky;top:0;z-index:2}
.modal-title{font-size:15px;font-weight:900}
.modal-x{width:30px;height:30px;border-radius:8px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,.07);border:1px solid var(--b0);color:var(--t1);cursor:pointer;font-size:18px;line-height:1;transition:all .15s}
.modal-x:hover{background:rgba(239,68,68,.12);color:#ef4444;border-color:rgba(239,68,46,.3)}
.modal-body{padding:20px;overflow-y:auto;flex:1;-webkit-overflow-scrolling:touch}
.modal-body::-webkit-scrollbar{width:2px}
.modal-body::-webkit-scrollbar-thumb{background:var(--red)}

/* â”€â”€ DETAIL MODAL â”€â”€ */
#detailOvl.open{align-items:flex-end}
@media(min-width:640px){#detailOvl.open{align-items:center}}

.detail-modal{
  background:#08080f;border:1px solid rgba(255,255,255,.10);
  border-radius:28px 28px 0 0;width:100%;max-width:780px;max-height:94svh;
  overflow:hidden;display:flex;flex-direction:column;
  transform:translateY(60px);opacity:0;
  transition:all .35s cubic-bezier(.25,.46,.45,.94);
  box-shadow:0 -8px 60px rgba(0,0,0,.8);
}
@media(min-width:640px){.detail-modal{border-radius:24px;max-height:90svh;transform:translateY(30px) scale(.97)}}
.overlay.open .detail-modal{transform:translateY(0) scale(1);opacity:1}

.d-gallery{position:relative;background:#000;flex-shrink:0}
.d-main-wrap{position:relative;overflow:hidden;aspect-ratio:1/1;background:#050510}
.d-main-img{width:100%;height:100%;object-fit:cover;display:block;transition:opacity .2s ease}

.d-arrow{position:absolute;top:50%;transform:translateY(-50%);width:40px;height:40px;border-radius:50%;background:rgba(0,0,0,.6);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.15);color:#fff;font-size:18px;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:10;transition:all .2s;-webkit-tap-highlight-color:transparent}
.d-arrow:hover{background:rgba(232,17,46,.7);border-color:rgba(232,17,46,.5)}
.d-arrow-prev{left:10px}
.d-arrow-next{right:10px}
.d-arrow.hidden{display:none}

.d-img-counter{position:absolute;top:12px;left:12px;z-index:10;padding:4px 10px;border-radius:100px;background:rgba(0,0,0,.65);backdrop-filter:blur(8px);font-size:11px;font-weight:800;color:rgba(255,255,255,.85)}

.d-thumbs{display:flex;gap:6px;padding:8px 14px;overflow-x:auto;background:#050510;-webkit-overflow-scrolling:touch;scrollbar-width:none}
.d-thumbs::-webkit-scrollbar{display:none}
.d-thumb{width:60px;height:60px;object-fit:cover;border-radius:8px;cursor:pointer;flex-shrink:0;border:2px solid transparent;opacity:.55;transition:all .2s}
.d-thumb.on{border-color:#e8112e;opacity:1}
.d-thumb:hover{opacity:.85}

.d-info{overflow-y:auto;flex:1;-webkit-overflow-scrolling:touch;padding:0}
.d-info::-webkit-scrollbar{width:2px}
.d-info::-webkit-scrollbar-thumb{background:rgba(232,17,46,.4)}

.d-header{padding:18px 20px 14px;border-bottom:1px solid rgba(255,255,255,.07);display:flex;align-items:flex-start;justify-content:space-between;gap:12px}
.d-name{font-size:1.4rem;font-weight:900;color:#fff;letter-spacing:-.4px;line-height:1.2}
.d-sub{font-size:12px;color:rgba(255,255,255,.5);font-weight:600;margin-top:4px;display:flex;align-items:center;gap:6px}
.d-sub-dot{width:3px;height:3px;border-radius:50%;background:rgba(255,255,255,.3)}
.d-price-block{text-align:left;flex-shrink:0}
.d-price{font-size:1.6rem;font-weight:900;background:linear-gradient(130deg,#ff4466,#e8112e);-webkit-background-clip:text;background-clip:text;color:transparent;letter-spacing:-.5px;line-height:1}
.d-price-lbl{font-size:10px;color:rgba(255,255,255,.4);font-weight:700;text-transform:uppercase;letter-spacing:.08em;margin-top:3px;text-align:left}

.d-close{position:absolute;top:12px;right:12px;z-index:20;width:36px;height:36px;border-radius:50%;background:rgba(0,0,0,.65);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);color:#fff;font-size:20px;line-height:1;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}
.d-close:hover{background:rgba(239,68,68,.7);border-color:transparent}

.d-specs-wrap{padding:14px 20px}
.d-specs-title{font-size:10px;font-weight:900;color:rgba(255,255,255,.35);text-transform:uppercase;letter-spacing:.14em;margin-bottom:10px}
.d-specs{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.d-spec{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px 10px;text-align:center;transition:border-color .2s}
.d-spec:hover{border-color:rgba(232,17,46,.3)}
.d-spec-icon{font-size:16px;margin-bottom:4px}
.d-spec-v{font-size:13px;font-weight:800;color:#fff;margin-bottom:2px}
.d-spec-k{font-size:9px;color:rgba(255,255,255,.4);font-weight:700;text-transform:uppercase;letter-spacing:.06em}

.d-desc{margin:0 20px 14px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.07);border-radius:14px;padding:14px 16px;font-size:13.5px;color:rgba(255,255,255,.75);line-height:1.75}

.d-seller{margin:0 20px 14px;background:linear-gradient(135deg,rgba(232,17,46,.07),rgba(232,17,46,.03));border:1px solid rgba(232,17,46,.2);border-radius:14px;padding:14px 16px;display:flex;align-items:center;gap:14px}
.d-seller-av{width:46px;height:46px;border-radius:50%;flex-shrink:0;background:linear-gradient(135deg,rgba(232,17,46,.3),rgba(200,16,46,.15));border:2px solid rgba(232,17,46,.35);display:flex;align-items:center;justify-content:center;font-size:20px}
.d-seller-name{font-weight:900;font-size:15px;color:#fff;margin-bottom:3px}
.d-seller-city{font-size:11.5px;color:rgba(255,255,255,.5);font-weight:600}

.d-ctas{padding:0 20px 20px;display:flex;gap:10px}
.cta-wa{flex:1;padding:14px 16px;border-radius:14px;display:flex;align-items:center;justify-content:center;gap:8px;font-size:14px;font-weight:900;transition:all .22s;text-decoration:none;background:linear-gradient(135deg,rgba(37,211,102,.15),rgba(37,211,102,.08));border:1.5px solid rgba(37,211,102,.35);color:#4ade80}
.cta-wa:hover{background:linear-gradient(135deg,rgba(37,211,102,.28),rgba(37,211,102,.15));transform:translateY(-2px);box-shadow:0 8px 24px rgba(37,211,102,.2)}
.cta-call{flex:1;padding:14px 16px;border-radius:14px;display:flex;align-items:center;justify-content:center;gap:8px;font-size:14px;font-weight:900;transition:all .22s;text-decoration:none;background:linear-gradient(135deg,rgba(59,130,246,.15),rgba(59,130,246,.08));border:1.5px solid rgba(59,130,246,.35);color:#60a5fa}
.cta-call:hover{background:linear-gradient(135deg,rgba(59,130,246,.28),rgba(59,130,246,.15));transform:translateY(-2px);box-shadow:0 8px 24px rgba(59,130,246,.2)}

/* â”€â”€ ADD MODAL â”€â”€ */
.add-modal{
  max-width:620px !important;border-radius:24px !important;
  overflow:hidden;display:flex;flex-direction:column;
  background:linear-gradient(160deg,#1a0008 0%,#0e0008 100%) !important;
  border:1px solid rgba(200,16,46,.3) !important;
  box-shadow:0 24px 80px rgba(200,16,46,.25),0 0 0 1px rgba(200,16,46,.15) !important;
}

.add-modal-head{display:flex;align-items:center;justify-content:space-between;padding:18px 20px;flex-shrink:0;background:linear-gradient(135deg,#c8102e 0%,#a00d24 40%,#7a0818 100%);position:relative;overflow:hidden}
.add-modal-head::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse 80% 120% at 30% -20%,rgba(255,100,100,.25) 0%,transparent 60%);pointer-events:none}
.add-head-logo{display:flex;align-items:center;gap:12px;position:relative;z-index:1}
.add-head-title{font-size:16px;font-weight:900;color:#fff;line-height:1.2;text-shadow:0 1px 6px rgba(0,0,0,.3)}
.add-head-sub{font-size:10.5px;font-weight:700;color:rgba(255,255,255,.65);text-transform:uppercase;letter-spacing:.1em;margin-top:2px}
.add-modal-head .modal-x{position:relative;z-index:1;background:rgba(255,255,255,.15);border-color:rgba(255,255,255,.25);color:#fff}
.add-modal-head .modal-x:hover{background:rgba(0,0,0,.25);border-color:rgba(255,255,255,.3)}

.add-upload-zone{flex-shrink:0;background:linear-gradient(160deg,rgba(200,16,46,.18) 0%,rgba(140,8,30,.14) 100%);border-bottom:1px solid rgba(200,16,46,.3);padding:14px 16px 12px;transition:background .2s}

/* Upload grid â€” Instagram-style */
.up-grid{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:8px;
}

/* + Add button cell */
.up-add-btn{
  aspect-ratio:1/1;border-radius:12px;
  background:rgba(200,16,46,.12);
  border:2px dashed rgba(200,16,46,.5);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  cursor:pointer;transition:all .2s;gap:4px;
  -webkit-tap-highlight-color:transparent;
}
.up-add-btn:hover,.up-add-btn:active{
  background:rgba(200,16,46,.22);
  border-color:rgba(200,16,46,.85);
  transform:scale(1.04);
}
.up-plus-icon{
  width:40px;height:40px;border-radius:50%;
  background:linear-gradient(135deg,#e8112e,#c8102e);
  display:flex;align-items:center;justify-content:center;
  color:#fff;box-shadow:0 4px 14px rgba(200,16,46,.45);
  transition:transform .2s,box-shadow .2s;
}
.up-add-btn:hover .up-plus-icon{transform:scale(1.12);box-shadow:0 6px 20px rgba(200,16,46,.65)}
.up-add-lbl{font-size:11px;font-weight:900;color:rgba(255,255,255,.85)}
.up-add-hint{font-size:9.5px;color:rgba(255,255,255,.4);font-weight:700}

/* Image preview cells */
.up-img-cell{
  aspect-ratio:1/1;border-radius:12px;
  overflow:hidden;position:relative;
  border:2px solid transparent;
  transition:all .2s;
  cursor:grab;
}
.up-img-cell.drag-over{border-color:rgba(200,16,46,.7);transform:scale(1.05)}
.up-img-cell.dragging{opacity:.5;transform:scale(.95)}
.up-img-cell img{
  width:100%;height:100%;object-fit:cover;display:block;
  transition:transform .25s;
}
.up-img-cell:hover img{transform:scale(1.08)}

/* Main badge on first image */
.up-img-cell:first-child .up-main-badge{display:flex}
.up-main-badge{
  display:none;
  position:absolute;bottom:5px;right:0;left:0;
  justify-content:center;
  pointer-events:none;z-index:2;
}
.up-main-badge span{
  background:linear-gradient(135deg,#e8112e,#c8102e);
  color:#fff;font-size:9px;font-weight:900;
  padding:2px 8px;border-radius:100px;
  letter-spacing:.06em;
  box-shadow:0 2px 8px rgba(200,16,46,.5);
}

/* Remove button */
.up-rm{
  position:absolute;top:5px;left:5px;z-index:3;
  width:22px;height:22px;border-radius:50%;
  background:rgba(0,0,0,.75);backdrop-filter:blur(4px);
  border:1.5px solid rgba(255,255,255,.3);
  color:#fff;font-size:12px;font-weight:900;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;transition:all .18s;
  line-height:1;
}
.up-rm:hover{background:rgba(239,68,68,.9);border-color:transparent;transform:scale(1.15)}

/* Drag handle indicator */
.up-drag-handle{
  position:absolute;top:5px;right:5px;z-index:3;
  width:20px;height:20px;
  display:flex;flex-direction:column;justify-content:center;align-items:center;gap:3px;
  opacity:0;transition:opacity .2s;
}
.up-img-cell:hover .up-drag-handle{opacity:1}
.up-drag-handle span{display:block;width:12px;height:1.5px;background:rgba(255,255,255,.7);border-radius:2px}

.prog{margin:10px 0 2px;display:none;background:rgba(255,255,255,.1);border-radius:100px;height:3px;overflow:hidden}
.prog-bar{height:100%;background:linear-gradient(90deg,var(--red),#e0162f);border-radius:100px;width:0%;transition:width .3s}

@media(max-width:500px){
  .up-grid{grid-template-columns:repeat(4,1fr);gap:6px}
}

.add-body-scroll{padding:0 !important;overflow-y:auto;flex:1;background:linear-gradient(180deg,#1a0008 0%,#12000a 40%,#0e000a 100%)}
.add-body-scroll form{padding:16px 18px 20px}

.add-section{margin-bottom:14px;padding:16px;border-radius:16px;background:rgba(200,16,46,.07);border:1px solid rgba(200,16,46,.22)}
.add-section-seller{background:rgba(200,16,46,.12);border-color:rgba(200,16,46,.35)}
.add-section-title{display:flex;align-items:center;gap:8px;font-size:11px;font-weight:900;color:rgba(255,180,180,.8);text-transform:uppercase;letter-spacing:.12em;margin-bottom:14px}
.add-section-dot{width:6px;height:6px;border-radius:50%;background:var(--red);box-shadow:0 0 8px var(--red);flex-shrink:0}

.add-row2{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px}
.add-row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:10px}

.fg-item{display:flex;flex-direction:column;gap:5px}
.fg-label{font-size:10px;font-weight:900;color:rgba(255,255,255,.6);text-transform:uppercase;letter-spacing:.1em}
.fg-input,.fg-sel,.fg-ta{background:rgba(0,0,0,.35);border:1.5px solid rgba(200,16,46,.3);color:#fff;padding:10px 13px;border-radius:11px;outline:none;transition:all .18s;width:100%;font-size:13.5px;font-family:var(--font)}
.fg-input:focus,.fg-sel:focus,.fg-ta:focus{border-color:rgba(200,16,46,.8);background:rgba(0,0,0,.45);box-shadow:0 0 0 3px rgba(200,16,46,.18)}
.fg-input::placeholder,.fg-ta::placeholder{color:rgba(255,255,255,.3)}
.fg-sel{appearance:none;-webkit-appearance:none}
.fg-sel option{background:#121224;color:#fff}
.fg-ta{resize:vertical;min-height:72px}

.submit-btn{width:100%;padding:15px;border-radius:14px;margin-top:14px;background:linear-gradient(135deg,#e8112e,#c8102e,#a00d22);color:#fff;border:none;font-size:15px;font-weight:900;cursor:pointer;box-shadow:0 6px 24px rgba(200,16,46,.45),inset 0 1px 0 rgba(255,255,255,.15);transition:all .2s;font-family:var(--font);display:flex;align-items:center;justify-content:center;gap:9px;letter-spacing:.02em}
.submit-btn:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 10px 32px rgba(200,16,46,.58),inset 0 1px 0 rgba(255,255,255,.2)}
.submit-btn:disabled{opacity:.6;cursor:not-allowed;transform:none}
.sub-icon{font-size:18px}

/* Toast */
#toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(70px);padding:12px 22px;border-radius:12px;font-size:13.5px;font-weight:800;z-index:9999;pointer-events:none;transition:all .28s var(--ease);background:rgba(10,10,20,.98);border:1px solid var(--b0);box-shadow:0 8px 28px rgba(0,0,0,.55);white-space:nowrap}
#toast.show{transform:translateX(-50%) translateY(0)}
#toast.ok{border-color:rgba(74,222,128,.4);color:#4ade80}
#toast.err{border-color:rgba(239,68,68,.4);color:#ef4444}

/* â”€â”€ RESPONSIVE â”€â”€ */
@media(max-width:900px){.nav-mid{display:none}}
@media(max-width:600px){
  :root{--nav:54px}
  #nav{padding:0 12px;height:54px;gap:7px}
  .btn-pkg-nav{display:none !important}
  .logo-israel{display:none}
  .logo-text{font-size:14px}
  #langTxt{display:none}
  .btn-lang{padding:6px 7px;gap:0}
  .btn-lang .lang-icon{width:28px;height:28px;border-radius:7px;font-size:10px}
  .btn-nav-post{padding:8px 13px !important;font-size:12px !important}
  .btn{padding:7px 12px;font-size:12px}
  .hero{padding:calc(54px + 44px) 16px 60px}
  .hero h1{font-size:2.2rem;letter-spacing:-1px}
  .hero-sub{font-size:.95rem}
  .hero-ctas{gap:8px}
  .hero-ctas .btn{padding:12px 20px;font-size:13.5px}
  .btn-pkg{padding:12px 18px;font-size:13px}
  .search-wrap{padding:36px 14px 0}
  .main{padding:28px 14px 80px}
  .cars-grid{grid-template-columns:repeat(2,1fr);gap:9px}
  .car-body{padding:10px;gap:7px}
  .car-name{font-size:12.5px}
  .car-meta{font-size:10px}
  .specs{gap:3px}
  .spec{font-size:9px;padding:2px 6px}
  .car-loc{font-size:9.5px}
  .act{width:28px;height:28px;font-size:13px}
  .car-img-wrap{aspect-ratio:1/1}
  .car-cnt{font-size:9px;padding:2px 5px}
  .modal{border-radius:20px 20px 0 0;max-height:94svh}
  .d-specs{grid-template-columns:repeat(2,1fr)}
  .d-ctas{flex-direction:column}
  .fg{grid-template-columns:1fr}
  .foot-in{flex-direction:column;gap:12px;text-align:center}
  .add-row2{grid-template-columns:1fr 1fr}
  .add-row3{grid-template-columns:1fr 1fr}
  .add-section{padding:12px}
  .add-body-scroll form{padding:12px 14px 16px}
}
@media(max-width:400px){
  .hero h1{font-size:1.9rem}
  .add-row2,.add-row3{grid-template-columns:1fr}
}
</style>
</head>
<body>

<!-- NAV -->
<nav id="nav">
  <div class="logo" onclick="showHome()">
    <div class="logo-box">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
           fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M5 17H3a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h13l4 4v4a2 2 0 0 1-2 2h-1"/>
        <circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/>
      </svg>
    </div>
    <span class="logo-text"><span class="r">YOUGO</span><span class="logo-cars"> CARS</span></span>
  </div>

  <div class="nav-mid">
    <button class="nav-a" onclick="scrollTo2('searchSec')">ğŸ” ×—×™×¤×•×©</button>
    <button class="nav-a" onclick="scrollTo2('listSec')">ğŸš— ××•×“×¢×•×ª</button>
    <button class="nav-a" onclick="open('https://yougo-roan.vercel.app','_blank')">ğŸŒ YOUGO ISRAEL</button>
  </div>

  <div class="nav-end">
    <button class="btn-lang" onclick="cycleLang()" id="langBtn">
      <span class="lang-icon" id="langIco">HE</span>
      <span id="langTxt">×¢×‘×¨×™×ª</span>
    </button>
    <a class="btn-pkg-nav" href="https://yougo-roan.vercel.app" target="_blank">ğŸ’¼ ×—×‘×™×œ×•×ª</a>
    <button class="btn btn-red btn-nav-post" onclick="openAdd()">+ <span id="navTxt">×¤×¨×¡× ×¨×›×‘</span></button>
  </div>
</nav>

<!-- ADMIN BAR -->
<div id="adminBar">
  <span style="font-weight:900;color:var(--red);font-size:13px">ğŸ”‘ Admin Mode</span>
  <div id="adminActs" style="display:flex;gap:7px;align-items:center;flex-wrap:wrap"></div>
</div>

<!-- HERO -->
<div class="hero" id="heroSec" style="margin-top:var(--nav)">
  <div class="hero-bg"></div>
  <div class="hero-grid"></div>
  <div class="hero-glow"></div>
  <div class="hero-in">
    <div class="hero-badge">
      <div class="badge-dot"></div>
      <span id="heroBadge">YOUGO ISRAEL â€” ×”×¤×œ×˜×¤×•×¨××” ×”××•×‘×™×œ×”</span>
    </div>
    <h1 id="heroH">×©×•×§ ×”×¨×›×‘×™× <span class="r">×”×“×™×’×™×˜×œ×™</span><br><span style="color:var(--t0)">×©×œ ×™×©×¨××œ</span></h1>
    <p class="hero-sub" id="heroSub">×§× ×” ×•××›×•×¨ ×¨×›×‘ ×‘×§×œ×•×ª ×•×‘××”×™×¨×•×ª. ××•×“×¢×•×ª ×××•××ª×•×ª ×¢× ××¤×©×¨×•×ª ×™×¦×™×¨×ª ×§×©×¨ ××™×™×“×™×ª.</p>
    <div class="hero-ctas">
      <button class="btn btn-red" onclick="openAdd()" id="hBtn1">ğŸš— ×¤×¨×¡× ×¨×›×‘ ×‘×—×™× ×</button>
      <button class="btn btn-ghost" onclick="scrollTo2('listSec')" id="hBtn2">ğŸ” ×—×¤×© ×¨×›×‘</button>
      <a class="btn-pkg" href="https://yougo-roan.vercel.app" target="_blank">
        <span>ğŸ’¼</span>
        <span id="hBtn3">×—×‘×™×œ×•×ª ×¤×¨×¡×•× ××§×¦×•×¢×™×•×ª</span>
        <span style="font-size:17px">â†</span>
      </a>
    </div>
    <div class="hero-stats">
      <div class="hs"><div class="hs-v" id="statCars">â€”</div><div class="hs-l" id="statCL">××•×“×¢×•×ª ×¤×¢×™×œ×•×ª</div></div>
      <div class="hs"><div class="hs-v">50K<span class="a">+</span></div><div class="hs-l" id="statFL">×¢×•×§×‘×™×</div></div>
      <div class="hs"><div class="hs-v">100<span class="a">%</span></div><div class="hs-l" id="statFrL">×—×™× × ×œ×¤×¨×¡×</div></div>
    </div>
  </div>
</div>

<!-- TICKER -->
<div class="ticker">
  <div class="ticker-inner">
    <div class="ti">âœ… ×¤×¨×¡×•× ×—×™× ××™ ××™×™×“×™</div>
    <div class="ti">âš¡ ×¤×¨×¡×•× ×‘-60 ×©× ×™×•×ª</div>
    <div class="ti">ğŸ“± ×¤× ×™×™×” ×™×©×™×¨×” ×‘-WhatsApp</div>
    <div class="ti">ğŸ”’ ×××•×‘×˜×— ×•×‘×˜×•×—</div>
    <div class="ti">ğŸŒ ×¢×‘×¨×™×ª Â· Ø¹Ø±Ø¨ÙŠØ© Â· English</div>
    <div class="ti">ğŸš€ YOUGO ISRAEL â€” 50K+ ×¢×•×§×‘×™×</div>
    <div class="ti">ğŸ‘ ××œ×¤×™ ×’×•×œ×©×™× ×™×•××™×™×</div>
    <div class="ti">âœ… ×¤×¨×¡×•× ×—×™× ××™ ××™×™×“×™</div>
    <div class="ti">âš¡ ×¤×¨×¡×•× ×‘-60 ×©× ×™×•×ª</div>
    <div class="ti">ğŸ“± ×¤× ×™×™×” ×™×©×™×¨×” ×‘-WhatsApp</div>
    <div class="ti">ğŸ”’ ×××•×‘×˜×— ×•×‘×˜×•×—</div>
    <div class="ti">ğŸŒ ×¢×‘×¨×™×ª Â· Ø¹Ø±Ø¨ÙŠØ© Â· English</div>
    <div class="ti">ğŸš€ YOUGO ISRAEL â€” 50K+ ×¢×•×§×‘×™×</div>
    <div class="ti">ğŸ‘ ××œ×¤×™ ×’×•×œ×©×™× ×™×•××™×™×</div>
  </div>
</div>

<!-- SEARCH -->
<div class="search-wrap" id="searchSec">
  <div class="search-eyebrow">
    <div class="search-eyebrow-line"></div>
    <span class="search-eyebrow-text">×—×™×¤×•×© ××ª×§×“×</span>
  </div>
  <div class="search-card">
    <div class="search-main">
      <span class="search-ico">ğŸ”</span>
      <input class="search-input" id="sTxt" placeholder="×—×¤×© ×œ×¤×™ ×™×¦×¨×Ÿ, ×“×’×, ×¢×™×¨..." oninput="doFilter()">
      <button class="search-go" onclick="doFilter()" id="sBtn">×—×¤×©</button>
    </div>
    <div class="filter-strip">
      <select class="fc" id="fMake" onchange="doFilter()"><option value="">ğŸš— ×›×œ ×”×™×¦×¨× ×™×</option></select>
      <select class="fc" id="fYear" onchange="doFilter()"><option value="">ğŸ“… ×›×œ ×”×©× ×™×</option></select>
      <select class="fc" id="fPrice" onchange="doFilter()">
        <option value="">ğŸ’° ×›×œ ×”××—×™×¨×™×</option>
        <option value="30000">×¢×“ â‚ª30,000</option>
        <option value="50000">×¢×“ â‚ª50,000</option>
        <option value="80000">×¢×“ â‚ª80,000</option>
        <option value="100000">×¢×“ â‚ª100,000</option>
        <option value="150000">×¢×“ â‚ª150,000</option>
        <option value="200000">×¢×“ â‚ª200,000</option>
      </select>
      <select class="fc" id="fCity" onchange="doFilter()"><option value="">ğŸ“ ×›×œ ×”×¢×¨×™×</option></select>
      <select class="fc" id="fGear" onchange="doFilter()">
        <option value="">ğŸ”„ ×›×œ ×”×’×™×¨×™×</option>
        <option value="××•×˜×•××˜">××•×˜×•××˜</option>
        <option value="×™×“× ×™">×™×“× ×™</option>
        <option value="CVT">CVT</option>
      </select>
      <select class="fc" id="fFuel" onchange="doFilter()">
        <option value="">â›½ ×›×œ ×”×“×œ×§×™×</option>
        <option value="×‘× ×–×™×Ÿ">×‘× ×–×™×Ÿ</option>
        <option value="×“×™×–×œ">×“×™×–×œ</option>
        <option value="×”×™×‘×¨×™×“×™">×”×™×‘×¨×™×“×™</option>
        <option value="×—×©××œ×™">×—×©××œ×™</option>
      </select>
    </div>
  </div>
</div>

<!-- LISTINGS -->
<div class="main" id="listSec">
  <div class="list-head">
    <h2 class="list-title" id="listTitle">××•×“×¢×•×ª <span class="r">×¤×¢×™×œ×•×ª</span></h2>
    <span class="cnt-badge" id="cntBadge">×˜×•×¢×Ÿ...</span>
  </div>
  <div class="sort-row">
    <button class="sort-btn on" onclick="doSort('newest',this)">ğŸ†• ×”×—×“×©×™×</button>
    <button class="sort-btn" onclick="doSort('price_asc',this)">ğŸ’° ××—×™×¨ × ××•×š</button>
    <button class="sort-btn" onclick="doSort('price_desc',this)">ğŸ’ ××—×™×¨ ×’×‘×•×”</button>
    <button class="sort-btn" onclick="doSort('km_asc',this)">ğŸ“ ×§"× × ××•×š</button>
  </div>
  <div id="carsBox">
    <div class="loading-box"><div class="spin"></div><p style="color:var(--t1);font-weight:600">××ª×—×‘×¨ ×œ××¡×“ × ×ª×•× ×™×...</p></div>
  </div>
</div>

<!-- FOOTER -->
<footer>
  <div class="foot-in">
    <div class="foot-brand">
      <div class="foot-box">
        <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M6 8l-1.8 2.35A4 4 0 0 0 3.2 12.87V16H5"/>
          <path d="M18 8H6L4 14h16l-2-6z" fill="rgba(255,255,255,.2)" stroke="#fff" stroke-width="1.6"/>
          <circle cx="7.5" cy="16.5" r="1.5" fill="#fff" stroke="none"/>
          <circle cx="16.5" cy="16.5" r="1.5" fill="#fff" stroke="none"/>
        </svg>
      </div>
      <span class="foot-name"><span class="r">YOUGO</span> ISRAEL</span>
    </div>
    <span class="foot-copy">Â© 2026 YOUGO ISRAEL â€” ×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª</span>
    <div class="foot-links">
      <a class="foot-link" href="https://yougo-roan.vercel.app" target="_blank">ğŸ’¼ YOUGO ISRAEL</a>
      <a class="foot-link" href="https://wa.me/972546980606" target="_blank">ğŸ’¬ WhatsApp</a>
      <span class="foot-dot" onclick="adminLogin()">â—</span>
    </div>
  </div>
</footer>

<!-- DETAIL MODAL -->
<div class="overlay" id="detailOvl" onclick="if(event.target.id==='detailOvl')closeDetail()">
  <div class="detail-modal" onclick="event.stopPropagation()">
    <div class="d-gallery" id="dGallery">
      <div class="d-main-wrap">
        <img class="d-main-img" id="dmImg" src="" alt="">
        <div class="d-img-counter" id="dCounter"></div>
        <button class="d-arrow d-arrow-prev hidden" id="dPrev" onclick="dNav(-1)">â€¹</button>
        <button class="d-arrow d-arrow-next hidden" id="dNext" onclick="dNav(1)">â€º</button>
        <button class="d-close" onclick="closeDetail()">Ã—</button>
      </div>
      <div class="d-thumbs" id="dThumbs"></div>
    </div>
    <div class="d-info" id="detailBody"></div>
  </div>
</div>

<!-- ADD MODAL -->
<div class="overlay" id="addOvl" onclick="if(event.target.id==='addOvl')closeAdd()">
  <div class="modal add-modal" onclick="event.stopPropagation()">
    <div class="add-modal-head">
      <div class="add-head-logo">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
          <path d="M18 8H6L4 14h16l-2-6z" fill="rgba(255,255,255,.25)" stroke="#fff" stroke-width="1.8" stroke-linejoin="round"/>
          <circle cx="7.5" cy="16.5" r="2" fill="#fff"/>
          <circle cx="16.5" cy="16.5" r="2" fill="#fff"/>
          <path d="M3 14h18" stroke="#fff" stroke-width="1.6" stroke-linecap="round"/>
          <path d="M5 14v2M19 14v2" stroke="#fff" stroke-width="1.4" stroke-linecap="round"/>
        </svg>
        <div>
          <div class="add-head-title" id="addTitle">×¤×¨×¡× ××ª ×”×¨×›×‘ ×©×œ×š</div>
          <div class="add-head-sub">YOUGO CARS â€” ×—×™× × ×•××™×™×“×™</div>
        </div>
      </div>
      <button class="modal-x" onclick="closeAdd()">Ã—</button>
    </div>

    <div class="add-upload-zone" id="uploadZone">
      <input type="file" id="imgIn" multiple accept="image/*" onchange="handleImgs(this)" style="display:none">
      
      <!-- Upload grid â€” shows + button + previews -->
      <div class="up-grid" id="upGrid">
        <!-- + button always first -->
        <div class="up-add-btn" onclick="document.getElementById('imgIn').click()" id="upAddBtn">
          <div class="up-plus-icon">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
              <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
          </div>
          <span class="up-add-lbl" id="upTxt">×”×•×¡×£ ×ª××•× ×•×ª</span>
          <span class="up-add-hint">×¢×“ 10</span>
        </div>
      </div>
      
      <div class="prog" id="prog"><div class="prog-bar" id="progBar"></div></div>
    </div>

    <div class="modal-body add-body-scroll" id="addBody">
      <form id="addForm" onsubmit="submitCar(event)">

        <div id="cfgTip" style="display:none;background:rgba(234,179,8,.1);border:1px solid rgba(234,179,8,.35);border-radius:12px;padding:12px 14px;margin-bottom:14px;font-size:12px;color:#fbbf24;line-height:1.6">
          âš™ï¸ <strong>×”×’×“×¨×ª Cloudinary:</strong><br>
          ×‘×“×•×§: Cloud name ×•-Upload Preset ×‘-Cloudinary Dashboard
        </div>

        <div class="add-section">
          <div class="add-section-title"><span class="add-section-dot"></span> ×¤×¨×˜×™ ×”×¨×›×‘</div>
          <div class="add-row2">
            <div class="fg-item"><label class="fg-label">×™×¦×¨×Ÿ *</label><input class="fg-input" id="f_make" placeholder="Toyota, BMW..." required></div>
            <div class="fg-item"><label class="fg-label">×“×’× *</label><input class="fg-input" id="f_model" placeholder="Corolla, X5..." required></div>
          </div>
          <div class="add-row3">
            <div class="fg-item"><label class="fg-label">×©× ×” *</label><input class="fg-input" id="f_year" type="number" min="1990" max="2026" placeholder="2021" required></div>
            <div class="fg-item"><label class="fg-label">××—×™×¨ â‚ª *</label><input class="fg-input" id="f_price" type="number" placeholder="75,000" required></div>
            <div class="fg-item"><label class="fg-label">×§"×</label><input class="fg-input" id="f_mileage" type="number" placeholder="80,000"></div>
          </div>
          <div class="add-row3">
            <div class="fg-item">
              <label class="fg-label">×™×“</label>
              <select class="fg-sel" id="f_hand">
                <option value="1">×™×“ 1</option><option value="2" selected>×™×“ 2</option>
                <option value="3">×™×“ 3</option><option value="4">×™×“ 4+</option>
              </select>
            </div>
            <div class="fg-item">
              <label class="fg-label">×’×™×¨</label>
              <select class="fg-sel" id="f_gear">
                <option value="××•×˜×•××˜">××•×˜×•××˜×™</option><option value="×™×“× ×™">×™×“× ×™</option><option value="CVT">CVT</option>
              </select>
            </div>
            <div class="fg-item">
              <label class="fg-label">×“×œ×§</label>
              <select class="fg-sel" id="f_fuel">
                <option value="×‘× ×–×™×Ÿ">×‘× ×–×™×Ÿ</option><option value="×“×™×–×œ">×“×™×–×œ</option>
                <option value="×”×™×‘×¨×™×“×™">×”×™×‘×¨×™×“×™</option><option value="×—×©××œ×™">×—×©××œ×™</option>
              </select>
            </div>
          </div>
          <div class="add-row2">
            <div class="fg-item"><label class="fg-label">×¦×‘×¢</label><input class="fg-input" id="f_color" placeholder="×œ×‘×Ÿ / ×©×—×•×¨..."></div>
            <div class="fg-item"><label class="fg-label">×× ×•×¢ (L)</label><input class="fg-input" id="f_engine" type="number" step="0.1" placeholder="1.6"></div>
          </div>
        </div>

        <div class="add-section">
          <div class="add-section-title"><span class="add-section-dot"></span> ×ª×™××•×¨ ×”×¨×›×‘</div>
          <div class="fg-item">
            <label class="fg-label">×ª×™××•×¨ ×‘×¢×‘×¨×™×ª</label>
            <textarea class="fg-ta" id="f_desc_he" placeholder="××¦×‘ ×”×¨×›×‘, ×ª×•×¡×¤×•×ª..." style="min-height:70px"></textarea>
          </div>
          <div class="fg-item" style="margin-top:8px">
            <label class="fg-label">ÙˆØµÙ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</label>
            <textarea class="fg-ta" id="f_desc_ar" placeholder="ÙˆØµÙ Ø§Ù„Ø³ÙŠØ§Ø±Ø©..." style="min-height:70px"></textarea>
          </div>
        </div>

        <div class="add-section add-section-seller">
          <div class="add-section-title"><span class="add-section-dot"></span> ×¤×¨×˜×™ ×”××•×›×¨</div>
          <div class="add-row2">
            <div class="fg-item"><label class="fg-label">×©× ××œ× *</label><input class="fg-input" id="f_name" placeholder="×™×©×¨××œ ×™×©×¨××œ×™" required></div>
            <div class="fg-item"><label class="fg-label">×˜×œ×¤×•×Ÿ *</label><input class="fg-input" id="f_phone" type="tel" placeholder="050-000-0000" required></div>
          </div>
          <div class="fg-item"><label class="fg-label">×¢×™×¨ *</label><input class="fg-input" id="f_city" placeholder="×ª×œ ××‘×™×‘, ×—×™×¤×”..." required></div>
        </div>

        <button type="submit" class="submit-btn" id="subBtn">
          <span class="sub-icon">ğŸš—</span>
          <span id="subBtnTxt">×¤×¨×¡× ××•×“×¢×” ×‘×—×™× × â€” ××™×™×“×™!</span>
        </button>

      </form>
    </div>
  </div>
</div>

<div id="toast"></div>

<script>
// â”€â”€ CONFIG â”€â”€
const SB_URL='https://arsbodqhmmtmoqqhykep.supabase.co';
const SB_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFyc2JvZHFobW10bW9xcWh5a2VwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIxNTgxMTQsImV4cCI6MjA4NzczNDExNH0.mt_WpPshp5xdbIx23pMmcwq7MhktA0-vWPIstOy1_HM';
const sb=supabase.createClient(SB_URL,SB_KEY);
const CL_NAME='dbd2dgqtl';
const CL_PRESET='htxdjln0';
const ADMIN_PW='yougo2026';
const TABLE='cars'; // â† ×©× ×”×˜×‘×œ×” ×‘-Supabase

// â”€â”€ STATE â”€â”€
let all=[],filtered=[],imgFiles=[],isAdmin=false,lang='he',sort='newest';

// â”€â”€ NAV SCROLL â”€â”€
window.addEventListener('scroll',()=>document.getElementById('nav').classList.toggle('solid',scrollY>40),{passive:true});
function scrollTo2(id){document.getElementById(id)?.scrollIntoView({behavior:'smooth'})}

// â”€â”€ LANG â”€â”€
const LANG_META={he:{code:'HE',label:'×¢×‘×¨×™×ª'},ar:{code:'AR',label:'Ø¹Ø±Ø¨ÙŠ'},en:{code:'EN',label:'English'}};
const T={
  he:{badge:'YOUGO ISRAEL â€” ×”×¤×œ×˜×¤×•×¨××” ×”××•×‘×™×œ×”',
    h1:'×©×•×§ ×”×¨×›×‘×™× <span class="r">×”×“×™×’×™×˜×œ×™</span><br><span style="color:var(--t0)">×©×œ ×™×©×¨××œ</span>',
    sub:'×§× ×” ×•××›×•×¨ ×¨×›×‘ ×‘×§×œ×•×ª ×•×‘××”×™×¨×•×ª. ××•×“×¢×•×ª ×××•××ª×•×ª ×¢× ××¤×©×¨×•×ª ×™×¦×™×¨×ª ×§×©×¨ ××™×™×“×™×ª.',
    b1:'ğŸš— ×¤×¨×¡× ×¨×›×‘ ×‘×—×™× ×',b2:'ğŸ” ×—×¤×© ×¨×›×‘',b3:'×—×‘×™×œ×•×ª ×¤×¨×¡×•× ××§×¦×•×¢×™×•×ª',
    cL:'××•×“×¢×•×ª ×¤×¢×™×œ×•×ª',fL:'×¢×•×§×‘×™×',frL:'×—×™× × ×œ×¤×¨×¡×',
    lT:'××•×“×¢×•×ª <span class="r">×¤×¢×™×œ×•×ª</span>',
    aT:'ğŸš— ×¤×¨×¡× ××ª ×”×¨×›×‘ ×©×œ×š',sub2:'ğŸš— ×¤×¨×¡× ××•×“×¢×” ×‘×—×™× × â€” ××™×™×“×™!',
    upT:'×œ×—×¥ ×œ×”×•×¡×¤×ª ×ª××•× ×•×ª <strong>(×¢×“ 10)</strong>',
    mk:'ğŸš— ×›×œ ×”×™×¦×¨× ×™×',yr:'ğŸ“… ×›×œ ×”×©× ×™×',pr:'ğŸ’° ×›×œ ×”××—×™×¨×™×',
    ct:'ğŸ“ ×›×œ ×”×¢×¨×™×',gr:'ğŸ”„ ×›×œ ×”×’×™×¨×™×',
    nc:'××™×Ÿ ××•×“×¢×•×ª ×ª×•×××•×ª',ncd:'× ×¡×” ×œ×©× ×•×ª ×¤×¨××˜×¨×™ ×—×™×¤×•×©',
    sold:'× ××›×¨',feat:'××•××œ×¥',nw:'âœ¨ ×—×“×©',
    na:'×¤×¨×¡× ×¨×›×‘',km:'×§"×',wa:'×©×œ×— WhatsApp',cl:'×”×ª×§×©×¨',
    ge:'×’×™×¨',fu:'×“×œ×§',sb2:'×—×¤×©',dir:'rtl'},
  ar:{badge:'YOUGO ISRAEL â€” Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø±Ø§Ø¦Ø¯Ø©',
    h1:'Ø³ÙˆÙ‚ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª <span class="r">Ø§Ù„Ø±Ù‚Ù…ÙŠ</span><br><span style="color:var(--t0)">ÙÙŠ Ø¥Ø³Ø±Ø§Ø¦ÙŠÙ„</span>',
    sub:'Ø§Ø´ØªØ±Ù ÙˆØ¨ÙØ¹ Ø³ÙŠØ§Ø±ØªÙƒ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ³Ø±Ø¹Ø©. Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…ÙˆØ«Ù‚Ø© Ù…Ø¹ ØªÙˆØ§ØµÙ„ ÙÙˆØ±ÙŠ.',
    b1:'ğŸš— Ø£Ø¹Ù„Ù† Ù…Ø¬Ø§Ù†Ø§Ù‹',b2:'ğŸ” ØªØµÙØ­',b3:'Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†',
    cL:'Ø¥Ø¹Ù„Ø§Ù† Ù†Ø´Ø·',fL:'Ù…ØªØ§Ø¨Ø¹',frL:'Ù†Ø´Ø± Ù…Ø¬Ø§Ù†ÙŠ',
    lT:'Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª <span class="r">Ø§Ù„Ù†Ø´Ø·Ø©</span>',
    aT:'ğŸš— Ø£Ø¶Ù Ø¥Ø¹Ù„Ø§Ù†Ùƒ',sub2:'ğŸš— Ø§Ù†Ø´Ø± Ø§Ù„Ø¢Ù† â€” Ù…Ø¬Ø§Ù†Ø§Ù‹!',
    upT:'Ø§Ù†Ù‚Ø± Ù„Ø¥Ø¶Ø§ÙØ© ØµÙˆØ± <strong>(Ø­ØªÙ‰ 10)</strong>',
    mk:'ğŸš— ÙƒÙ„ Ø§Ù„Ù…Ø§Ø±ÙƒØ§Øª',yr:'ğŸ“… ÙƒÙ„ Ø§Ù„Ø³Ù†ÙˆØ§Øª',pr:'ğŸ’° ÙƒÙ„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±',
    ct:'ğŸ“ ÙƒÙ„ Ø§Ù„Ù…Ø¯Ù†',gr:'ğŸ”„ ÙƒÙ„ Ø§Ù„Ù†Ø§Ù‚Ù„Ø§Øª',
    nc:'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª',ncd:'Ø¬Ø±Ù‘Ø¨ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±',
    sold:'Ù…Ø¨Ø§Ø¹',feat:'Ù…Ù…ÙŠØ²',nw:'âœ¨ Ø¬Ø¯ÙŠØ¯',
    na:'Ø£Ø¹Ù„Ù† Ø¹Ù† Ø³ÙŠØ§Ø±ØªÙƒ',km:'ÙƒÙ…',wa:'ÙˆØ§ØªØ³Ø§Ø¨',cl:'Ø§ØªØµÙ„',
    ge:'Ù†Ø§Ù‚Ù„',fu:'ÙˆÙ‚ÙˆØ¯',sb2:'Ø¨Ø­Ø«',dir:'rtl'},
  en:{badge:'YOUGO ISRAEL â€” The Leading Platform',
    h1:'Israel\'s <span class="r">Digital</span><br><span style="color:var(--t0)">Car Market</span>',
    sub:'Buy and sell cars easily. Verified listings with instant contact.',
    b1:'ğŸš— Post Free',b2:'ğŸ” Browse',b3:'Professional Packages',
    cL:'Active Listings',fL:'Followers',frL:'Free to Post',
    lT:'<span class="r">Active</span> Listings',
    aT:'ğŸš— Post Your Car',sub2:'ğŸš— Post Now â€” Free!',
    upT:'Click to add photos <strong>(up to 10)</strong>',
    mk:'ğŸš— All Makes',yr:'ğŸ“… All Years',pr:'ğŸ’° All Prices',
    ct:'ğŸ“ All Cities',gr:'ğŸ”„ All Gears',
    nc:'No listings found',ncd:'Try changing filters',
    sold:'Sold',feat:'Featured',nw:'âœ¨ New',
    na:'Post Car',km:'km',wa:'WhatsApp',cl:'Call',
    ge:'Gear',fu:'Fuel',sb2:'Search',dir:'ltr'}
};
const t=k=>T[lang]?.[k]||T.he[k]||k;

function cycleLang(){const l=['he','ar','en'];lang=l[(l.indexOf(lang)+1)%3];applyLang()}
function applyLang(){
  const L=T[lang],M=LANG_META[lang];
  document.documentElement.lang=lang;document.documentElement.dir=L.dir;
  document.getElementById('langIco').textContent=M.code;
  document.getElementById('langTxt').textContent=M.label;
  document.getElementById('heroBadge').textContent=L.badge;
  document.getElementById('heroH').innerHTML=L.h1;
  document.getElementById('heroSub').textContent=L.sub;
  document.getElementById('hBtn1').textContent=L.b1;
  document.getElementById('hBtn2').textContent=L.b2;
  document.getElementById('hBtn3').textContent=L.b3;
  document.getElementById('navTxt').textContent=L.na;
  document.getElementById('statCL').textContent=L.cL;
  document.getElementById('statFL').textContent=L.fL;
  document.getElementById('statFrL').textContent=L.frL;
  document.getElementById('listTitle').innerHTML=L.lT;
  document.getElementById('addTitle').textContent=L.aT;
  const s=document.getElementById('subBtnTxt');if(s)s.textContent=L.sub2;
  document.getElementById('upTxt').innerHTML=L.upT;
  document.getElementById('sBtn').textContent=L.sb2;
  document.getElementById('fMake').options[0].text=L.mk;
  document.getElementById('fYear').options[0].text=L.yr;
  document.getElementById('fPrice').options[0].text=L.pr;
  document.getElementById('fCity').options[0].text=L.ct;
  document.getElementById('fGear').options[0].text=L.gr;
  renderCars(filtered);
}

// â”€â”€ LOAD CARS â€” FIX: better error handling + empty state â”€â”€
async function loadCars(){
  const box=document.getElementById('carsBox');
  box.innerHTML='<div class="loading-box"><div class="spin"></div><p style="color:var(--t1);font-weight:600">××ª×—×‘×¨ ×œ××¡×“ × ×ª×•× ×™×...</p></div>';

  try{
    // Test connection first with a simple query
    const q=isAdmin
      ? sb.from(TABLE).select('*').order('created_at',{ascending:false})
      : sb.from(TABLE).select('*').eq('status','active').order('created_at',{ascending:false});

    const{data,error}=await q;

    console.log('[YOUGO] DB Response:', {data, error, count: data?.length});

    if(error){
      // Handle specific Supabase errors
      let msg=error.message||'×©×’×™××ª ××¡×“ × ×ª×•× ×™×';
      let hint='';

      if(error.code==='PGRST301'||msg.includes('JWT')){
        hint='×‘×¢×™×™×ª ×”×¨×©××•×ª â€” ×™×™×ª×›×Ÿ ×©×”-Row Level Security (RLS) ××¡×•×¨×’. ×›× ×¡ ×œ-Supabase â†’ Authentication â†’ Policies';
      } else if(error.code==='42P01'||msg.includes('relation')||msg.includes('does not exist')){
        hint=`×”×˜×‘×œ×” "${TABLE}" ×œ× ×§×™×™××ª â€” ×¦×•×¨ ××•×ª×” ×‘-Supabase SQL Editor`;
      } else if(msg.includes('Failed to fetch')||msg.includes('NetworkError')){
        hint='×‘×¢×™×™×ª ×¨×©×ª â€” ×‘×“×•×§ ×—×™×‘×•×¨ ××™× ×˜×¨× ×˜';
      } else {
        hint='×§×•×“ ×©×’×™××”: '+error.code+' | '+error.details;
      }

      box.innerHTML=`
        <div class="db-error-banner">
          <h3>âš ï¸ ×©×’×™××ª ×—×™×‘×•×¨ ×œ××¡×“ ×”× ×ª×•× ×™×</h3>
          <p><strong>${msg}</strong></p>
          ${hint?`<p style="color:rgba(255,200,200,.7);margin-top:6px">${hint}</p>`:''}
          <code>${error.code||'UNKNOWN'}</code>
          <div style="margin-top:16px;display:flex;gap:8px;justify-content:center;flex-wrap:wrap">
            <button class="btn btn-red" style="padding:10px 24px" onclick="loadCars()">ğŸ”„ × ×¡×” ×©×•×‘</button>
            <button class="btn" style="background:rgba(255,255,255,.08);color:var(--t1);padding:10px 24px" onclick="openAdd()">+ ×¤×¨×¡× ×¨×›×‘</button>
          </div>
        </div>`;
      document.getElementById('cntBadge').textContent='×©×’×™××”';
      return;
    }

    all=data||[];
    filtered=[...all];
    buildFilters();
    doSort(sort);
    document.getElementById('statCars').textContent=all.filter(c=>c.status==='active').length;

  }catch(e){
    console.error('[YOUGO] loadCars catch:', e);
    let errMsg=e.message||'×©×’×™××” ×œ× ×™×“×•×¢×”';
    let isNetwork=errMsg.includes('fetch')||errMsg.includes('network')||errMsg.includes('Network');

    box.innerHTML=`
      <div class="db-error-banner">
        <h3>${isNetwork?'ğŸ“¡ ×‘×¢×™×™×ª ×—×™×‘×•×¨ ×¨×©×ª':'âš ï¸ ×©×’×™××”'}</h3>
        <p>${errMsg}</p>
        ${isNetwork?'<p style="color:rgba(255,200,200,.7);margin-top:6px">×‘×“×•×§ ×—×™×‘×•×¨ ××™× ×˜×¨× ×˜ ×•× ×¡×” ×©×•×‘</p>':''}
        <div style="margin-top:16px;display:flex;gap:8px;justify-content:center">
          <button class="btn btn-red" style="padding:10px 24px" onclick="loadCars()">ğŸ”„ × ×¡×” ×©×•×‘</button>
        </div>
      </div>`;
    document.getElementById('cntBadge').textContent='×©×’×™××”';
  }
}

function buildFilters(){
  const makes=[...new Set(all.map(c=>c.make).filter(Boolean))].sort();
  const years=[...new Set(all.map(c=>c.year).filter(Boolean))].sort((a,b)=>b-a);
  const cities=[...new Set(all.map(c=>c.seller_city).filter(Boolean))].sort();
  const mk=document.getElementById('fMake'),yr=document.getElementById('fYear'),ct=document.getElementById('fCity');
  const[cm,cy,cc]=[mk.value,yr.value,ct.value];
  while(mk.options.length>1)mk.remove(1);
  while(yr.options.length>1)yr.remove(1);
  while(ct.options.length>1)ct.remove(1);
  makes.forEach(m=>mk.add(new Option(m,m)));
  years.forEach(y=>yr.add(new Option(y,y)));
  cities.forEach(c=>ct.add(new Option(c,c)));
  mk.value=cm;yr.value=cy;ct.value=cc;
}

function doFilter(){
  const tx=document.getElementById('sTxt').value.toLowerCase();
  const mk=document.getElementById('fMake').value,yr=document.getElementById('fYear').value;
  const pr=document.getElementById('fPrice').value,ct=document.getElementById('fCity').value;
  const gr=document.getElementById('fGear').value,fu=document.getElementById('fFuel').value;
  filtered=all.filter(c=>{
    if(tx&&!`${c.make} ${c.model} ${c.seller_city} ${c.color}`.toLowerCase().includes(tx))return false;
    if(mk&&c.make!==mk)return false;
    if(yr&&c.year!=yr)return false;
    if(pr&&c.price>parseInt(pr))return false;
    if(ct&&c.seller_city!==ct)return false;
    if(gr&&c.gear_type!==gr)return false;
    if(fu&&c.fuel_type!==fu)return false;
    return true;
  });
  doSort(sort);
}

function doSort(type,btn){
  sort=type;
  if(btn){document.querySelectorAll('.sort-btn').forEach(b=>b.classList.remove('on'));btn.classList.add('on')}
  const s=[...filtered];
  if(type==='price_asc')s.sort((a,b)=>a.price-b.price);
  else if(type==='price_desc')s.sort((a,b)=>b.price-a.price);
  else if(type==='km_asc')s.sort((a,b)=>(a.mileage||999999)-(b.mileage||999999));
  else s.sort((a,b)=>new Date(b.created_at)-new Date(a.created_at));
  renderCars(s);
  document.getElementById('cntBadge').textContent=filtered.length+' ××•×“×¢×•×ª';
}

// â”€â”€ RENDER CARS â€” FIX: better empty state â”€â”€
function renderCars(cars){
  const c=document.getElementById('carsBox');
  if(!cars.length){
    // Check if DB is empty or filter returned nothing
    const isFiltered=document.getElementById('sTxt').value||
      document.getElementById('fMake').value||document.getElementById('fYear').value||
      document.getElementById('fPrice').value||document.getElementById('fCity').value;

    if(!isFiltered && all.length===0){
      // DB is actually empty
      c.innerHTML=`
        <div class="empty-state">
          <div class="empty-state-icon">ğŸš—</div>
          <h3>×¢×“×™×™×Ÿ ××™×Ÿ ××•×“×¢×•×ª</h3>
          <p>×”×™×” ×”×¨××©×•×Ÿ ×œ×¤×¨×¡× ×¨×›×‘ ×‘-YOUGO CARS!</p>
          <button class="btn btn-red" style="padding:14px 32px;font-size:14px" onclick="openAdd()">
            ğŸš— ×¤×¨×¡× ×¨×›×‘ ×‘×—×™× ×
          </button>
        </div>`;
    } else {
      c.innerHTML=`
        <div class="empty-state">
          <div class="empty-state-icon">ğŸ”</div>
          <h3>${t('nc')}</h3>
          <p>${t('ncd')}</p>
          <button class="btn" style="background:rgba(255,255,255,.08);color:var(--t1);padding:10px 22px;margin-top:4px" onclick="clearFilters()">
            âœ• × ×§×” ×¤×™×œ×˜×¨×™×
          </button>
        </div>`;
    }
    return;
  }
  c.innerHTML=`<div class="cars-grid">${cars.map(carCard).join('')}</div>`;
}

function clearFilters(){
  document.getElementById('sTxt').value='';
  document.getElementById('fMake').value='';
  document.getElementById('fYear').value='';
  document.getElementById('fPrice').value='';
  document.getElementById('fCity').value='';
  document.getElementById('fGear').value='';
  document.getElementById('fFuel').value='';
  doFilter();
}

function carCard(car){
  const is=car.images||[],im=car.main_image||is[0];
  const ph2=(car.seller_phone||'').replace(/\D/g,'').replace(/^0/,'');
  const isNew=(Date.now()-new Date(car.created_at))<86400000*3&&car.status!=='sold';
  const badges=[];
  if(car.featured)badges.push(`<span class="cbadge cb-feat">â˜… ${t('feat')}</span>`);
  if(car.status==='sold')badges.push(`<span class="cbadge cb-sold">âœ“ ${t('sold')}</span>`);
  if(isNew)badges.push(`<span class="cbadge cb-new">NEW</span>`);
  const adminRow=isAdmin?`<div class="admin-row">
    ${car.status==='pending'?`<button class="a-btn a-approve" onclick="approve('${car.id}');event.stopPropagation()">âœ“ ××©×¨</button>`:''}
    ${car.status==='active'?`<button class="a-btn a-sold" onclick="markSold('${car.id}');event.stopPropagation()">ğŸ’° × ××›×¨</button>`:''}
    <button class="a-btn a-del" onclick="delCar('${car.id}');event.stopPropagation()">âœ•</button>
  </div>`:'';
  return`<div class="car-card" onclick="openDetail('${car.id}')">
    <div class="car-img-outer">
    <div class="car-img-wrap">
      ${im
        ?`<img class="car-img" src="${im}" alt="${car.make} ${car.model}" loading="lazy">`
        :`<div class="car-placeholder">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="rgba(255,255,255,.25)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M5 17H3a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h13l4 4v4a2 2 0 0 1-2 2h-1"/>
            <circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/>
          </svg>
        </div>`}
      <div class="car-badges">${badges.join('')}</div>
      ${is.length>1?`<div class="car-cnt">ğŸ“· ${is.length}</div>`:''}
      <div class="car-price-float"><small>â‚ª</small>${Number(car.price).toLocaleString()}</div>
    </div>
    </div>
    ${car.status==='pending'&&isAdmin?'<div class="pend-bar">â³ ×××ª×™×Ÿ ×œ××™×©×•×¨</div>':''}
    <div class="car-body">
      <div class="car-name">${car.make} ${car.model}</div>
      <div class="car-meta">
        <span>${car.year}</span>
        ${car.hand?`<span class="car-meta-dot"></span><span>×™×“ ${car.hand}</span>`:''}
        ${car.seller_city?`<span class="car-meta-dot"></span><span>${car.seller_city}</span>`:''}
      </div>
      <div class="specs">
        ${car.gear_type?`<span class="spec"><span class="spec-icon">âš™</span>${car.gear_type}</span>`:''}
        ${car.fuel_type?`<span class="spec"><span class="spec-icon">â›½</span>${car.fuel_type}</span>`:''}
        ${car.mileage?`<span class="spec"><span class="spec-icon">â—</span>${Number(car.mileage).toLocaleString()} ${t('km')}</span>`:''}
      </div>
    </div>
    <div class="car-foot">
      <span class="car-loc">ğŸ“ ${car.seller_city||'â€”'}</span>
      <div class="car-acts" onclick="event.stopPropagation()">
        <a class="act act-wa" href="https://wa.me/972${ph2}" target="_blank" title="WhatsApp">
          <svg width="15" height="15" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/><path d="M12 0C5.373 0 0 5.373 0 12c0 2.127.558 4.122 1.532 5.856L.057 23.49a.5.5 0 0 0 .617.608l5.76-1.504A11.943 11.943 0 0 0 12 24c6.627 0 12-5.373 12-12S18.627 0 12 0zm0 22c-1.99 0-3.85-.552-5.44-1.51l-.39-.23-4.04 1.056 1.072-3.924-.253-.404A10 10 0 0 1 2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10z"/></svg>
        </a>
        <a class="act act-call" href="tel:${car.seller_phone}" title="Call">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.69 12 19.79 19.79 0 0 1 1.61 3.41 2 2 0 0 1 3.6 1.21h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L7.91 9a16 16 0 0 0 6 6l.92-.92a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 21.73 16.92z"/></svg>
        </a>
      </div>
    </div>
    ${adminRow}
  </div>`;
}

// â”€â”€ DETAIL MODAL â”€â”€
let _dImgs=[],_dIdx=0;

function openDetail(id){
  const car=all.find(c=>c.id===id);if(!car)return;
  _dImgs=car.images?.length?car.images:(car.main_image?[car.main_image]:[]);
  _dIdx=0;
  const ph2=(car.seller_phone||'').replace(/\D/g,'').replace(/^0/,'');
  const gallery=document.getElementById('dGallery');
  const dmImg=document.getElementById('dmImg');
  const dThumbs=document.getElementById('dThumbs');
  const dCounter=document.getElementById('dCounter');

  if(_dImgs.length>0){
    gallery.style.display='';
    dmImg.src=_dImgs[0];
    dmImg.alt=car.make+' '+car.model;
    dCounter.textContent='1 / '+_dImgs.length;
    if(_dImgs.length>1){
      dThumbs.style.display='';
      dThumbs.innerHTML=_dImgs.map((s,i)=>'<img class="d-thumb '+(i===0?'on':'')+'" src="'+s+'" onclick="dGoTo('+i+')" loading="lazy">').join('');
      document.getElementById('dPrev').classList.remove('hidden');
      document.getElementById('dNext').classList.remove('hidden');
    }else{
      dThumbs.style.display='none';dThumbs.innerHTML='';
      document.getElementById('dPrev').classList.add('hidden');
      document.getElementById('dNext').classList.add('hidden');
    }
  }else{gallery.style.display='none'}

  const specs=[
    car.mileage?{icon:'â—',v:Number(car.mileage).toLocaleString(),k:t('km')}:null,
    {icon:'âš™',v:car.gear_type||'â€”',k:t('ge')},
    {icon:'â›½',v:car.fuel_type||'â€”',k:t('fu')},
    car.color?{icon:'â—‰',v:car.color,k:'×¦×‘×¢'}:null,
    car.engine_size?{icon:'â–²',v:car.engine_size+'L',k:'×× ×•×¢'}:null,
    car.hand?{icon:'âœ‹',v:'×™×“ '+car.hand,k:'×™×“'}:null,
  ].filter(Boolean);

  const waMsg=encodeURIComponent('×©×œ×•×, ×¨××™×ª×™ ××ª ×”××•×“×¢×” ×©×œ '+car.make+' '+car.model+' '+car.year+' ×‘-YOUGO CARS');

  document.getElementById('detailBody').innerHTML=
    '<div class="d-header">'+
      '<div class="d-title-block">'+
        '<div class="d-name">'+car.make+' '+car.model+'</div>'+
        '<div class="d-sub">'+
          '<span>'+car.year+'</span>'+
          (car.hand?'<span class="d-sub-dot"></span><span>×™×“ '+car.hand+'</span>':'')+
          (car.seller_city?'<span class="d-sub-dot"></span><span>'+car.seller_city+'</span>':'')+
        '</div>'+
      '</div>'+
      '<div class="d-price-block">'+
        '<div class="d-price">â‚ª'+Number(car.price).toLocaleString()+'</div>'+
        '<div class="d-price-lbl">××—×™×¨ ××‘×•×§×©</div>'+
      '</div>'+
    '</div>'+
    '<div class="d-specs-wrap">'+
      '<div class="d-specs-title">××¤×¨×˜ ×˜×›× ×™</div>'+
      '<div class="d-specs">'+specs.map(s=>'<div class="d-spec"><div class="d-spec-icon">'+s.icon+'</div><div class="d-spec-v">'+s.v+'</div><div class="d-spec-k">'+s.k+'</div></div>').join('')+'</div>'+
    '</div>'+
    (car.description_he?'<div class="d-desc">'+car.description_he+'</div>':'')+
    '<div class="d-seller">'+
      '<div class="d-seller-av">ğŸ‘¤</div>'+
      '<div><div class="d-seller-name">'+(car.seller_name||'â€”')+'</div>'+
      '<div class="d-seller-city">ğŸ“ '+(car.seller_city||'â€”')+'</div></div>'+
    '</div>'+
    '<div class="d-ctas">'+
      '<a class="cta-wa" href="https://wa.me/972'+ph2+'?text='+waMsg+'" target="_blank">'+
        '<svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/><path d="M12 0C5.373 0 0 5.373 0 12c0 2.127.558 4.122 1.532 5.856L.057 23.49a.5.5 0 0 0 .617.608l5.76-1.504A11.943 11.943 0 0 0 12 24c6.627 0 12-5.373 12-12S18.627 0 12 0zm0 22c-1.99 0-3.85-.552-5.44-1.51l-.39-.23-4.04 1.056 1.072-3.924-.253-.404A10 10 0 0 1 2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10z"/></svg>'+
        'WhatsApp</a>'+
      '<a class="cta-call" href="tel:'+car.seller_phone+'">'+
        '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.69 12 19.79 19.79 0 0 1 1.61 3.41 2 2 0 0 1 3.6 1.21h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L7.91 9a16 16 0 0 0 6 6l.92-.92a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 21.73 16.92z"/></svg>'+
        car.seller_phone+'</a>'+
    '</div>'+
    (isAdmin?
      '<div style="display:flex;gap:8px;margin:0 20px 20px">'+
        (car.status==='pending'?`<button onclick="approve('${car.id}');closeDetail()" style="flex:1;padding:13px;background:rgba(74,222,128,.1);border:1px solid rgba(74,222,128,.3);color:#4ade80;border-radius:12px;cursor:pointer;font-size:13px;font-weight:900;font-family:var(--font)">âœ“ ××©×¨ ××•×“×¢×”</button>`:'') +
        `<button onclick="delCar('${car.id}');closeDetail()" style="flex:1;padding:13px;background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.3);color:#ef4444;border-radius:12px;cursor:pointer;font-size:13px;font-weight:900;font-family:var(--font)">ğŸ—‘ ××—×§</button>`+
      '</div>'
    :'');

  document.getElementById('detailOvl').classList.add('open');
  document.body.style.overflow='hidden';
}

function dGoTo(i){
  if(i<0||i>=_dImgs.length)return;
  _dIdx=i;
  const img=document.getElementById('dmImg');
  img.style.opacity='0';
  setTimeout(()=>{img.src=_dImgs[i];img.style.opacity='1'},200);
  document.getElementById('dCounter').textContent=(i+1)+' / '+_dImgs.length;
  document.querySelectorAll('.d-thumb').forEach((th,j)=>th.classList.toggle('on',j===i));
}
function dNav(dir){dGoTo(_dIdx+dir)}
function closeDetail(){document.getElementById('detailOvl').classList.remove('open');document.body.style.overflow=''}

// â”€â”€ ADD MODAL â”€â”€
function openAdd(){
  document.getElementById('addOvl').classList.add('open');
  document.getElementById('addForm').reset();
  imgFiles=[];
  renderUpGrid();
  const errBox=document.getElementById('formErrBox');
  if(errBox)errBox.remove();
}
function closeAdd(){document.getElementById('addOvl').classList.remove('open')}

// â”€â”€ UPLOAD GRID â€” Instagram style â”€â”€
let imgFiles=[];

function handleImgs(input){
  const newFiles=[...input.files].slice(0,10-imgFiles.length);
  // Compress/resize each image before adding
  newFiles.forEach(f=>{
    resizeImage(f, 1200, (blob)=>{
      // Create new File from blob keeping name
      const resized=new File([blob], f.name, {type:'image/jpeg',lastModified:Date.now()});
      imgFiles.push(resized);
      if(imgFiles.length>10) imgFiles=imgFiles.slice(0,10);
      renderUpGrid();
    });
  });
  input.value=''; // reset so same file can be re-added
}

// Auto-resize image to max dimension
function resizeImage(file, maxSize, cb){
  const reader=new FileReader();
  reader.onload=e=>{
    const img=new Image();
    img.onload=()=>{
      let w=img.width,h=img.height;
      if(w>maxSize||h>maxSize){
        if(w>h){h=Math.round(h*maxSize/w);w=maxSize}
        else{w=Math.round(w*maxSize/h);h=maxSize}
      }
      const canvas=document.createElement('canvas');
      canvas.width=w;canvas.height=h;
      const ctx=canvas.getContext('2d');
      ctx.drawImage(img,0,0,w,h);
      canvas.toBlob(blob=>cb(blob),'image/jpeg',0.88);
    };
    img.src=e.target.result;
  };
  reader.readAsDataURL(file);
}

function renderUpGrid(){
  const grid=document.getElementById('upGrid');
  // Keep + button, rebuild image cells
  const cells=imgFiles.map((f,i)=>{
    const url=URL.createObjectURL(f);
    return`<div class="up-img-cell" draggable="true"
      ondragstart="dragStart(${i})" ondragover="dragOver(event,${i})"
      ondrop="dragDrop(event,${i})" ondragend="dragEnd()">
      <img src="${url}" alt="">
      <div class="up-main-badge"><span>×¨××©×™×ª</span></div>
      <button class="up-rm" onclick="rmImg(${i});event.stopPropagation()" type="button">Ã—</button>
      <div class="up-drag-handle"><span></span><span></span><span></span></div>
    </div>`;
  }).join('');

  // + button (hidden if 10 reached)
  const addBtn=imgFiles.length<10
    ?`<div class="up-add-btn" onclick="document.getElementById('imgIn').click()">
        <div class="up-plus-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round">
            <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
          </svg>
        </div>
        <span class="up-add-lbl">${imgFiles.length===0?'×”×•×¡×£ ×ª××•× ×•×ª':'×”×•×¡×£ ×¢×•×“'}</span>
        <span class="up-add-hint">${imgFiles.length}/10</span>
      </div>`
    :'';

  grid.innerHTML=cells+addBtn;
}

function rmImg(i){
  imgFiles.splice(i,1);
  renderUpGrid();
}

// Drag to reorder
let dragIdx=null;
function dragStart(i){dragIdx=i;setTimeout(()=>{const cells=document.querySelectorAll('.up-img-cell');if(cells[i])cells[i].classList.add('dragging')},0)}
function dragOver(e,i){e.preventDefault();document.querySelectorAll('.up-img-cell').forEach((c,j)=>c.classList.toggle('drag-over',j===i&&j!==dragIdx))}
function dragDrop(e,i){
  e.preventDefault();
  if(dragIdx===null||dragIdx===i)return;
  const tmp=imgFiles[dragIdx];imgFiles[dragIdx]=imgFiles[i];imgFiles[i]=tmp;
  dragIdx=null;renderUpGrid();
}
function dragEnd(){dragIdx=null;document.querySelectorAll('.up-img-cell').forEach(c=>{c.classList.remove('dragging','drag-over')})}

// â”€â”€ ADD MODAL â”€â”€

async function uploadImg(file){
  const fd=new FormData();
  fd.append('file',file);
  fd.append('upload_preset',CL_PRESET);
  fd.append('folder','yougo-cars');
  const r=await fetch(`https://api.cloudinary.com/v1_1/${CL_NAME}/image/upload`,{method:'POST',body:fd});
  const json=await r.json();
  if(!r.ok||json.error){
    const msg=json.error?.message||'HTTP '+r.status;
    if(msg.toLowerCase().includes('unknown api key')||msg.toLowerCase().includes('invalid')){
      const tip=document.getElementById('cfgTip');if(tip)tip.style.display='block';
      throw new Error('Cloudinary config ×©×’×•×™ â€” ×‘×“×•×§ Cloud Name ×•-Upload Preset');
    }
    throw new Error('×”×¢×œ××ª ×ª××•× ×” × ×›×©×œ×”: '+msg);
  }
  return json.secure_url;
}

function getErrMsg(err){
  if(!err)return '×©×’×™××” ×œ× ×™×“×•×¢×”';
  if(typeof err==='string')return err;
  if(err.message)return err.message;
  if(err.details)return err.details;
  if(err.code)return '×§×•×“: '+err.code;
  try{return JSON.stringify(err)}catch(e){return '×©×’×™××” ×œ× ×™×“×•×¢×”'}
}

function showErrInForm(msg){
  let box=document.getElementById('formErrBox');
  if(!box){
    box=document.createElement('div');
    box.id='formErrBox';
    box.style.cssText='background:rgba(239,68,68,.12);border:1px solid rgba(239,68,68,.4);color:#fca5a5;border-radius:12px;padding:14px 16px;font-size:13px;font-weight:700;margin-top:12px;line-height:1.5;word-break:break-word;';
    document.getElementById('subBtn').after(box);
  }
  box.innerHTML='âŒ '+msg;
  box.scrollIntoView({behavior:'smooth',block:'nearest'});
}

async function submitCar(e){
  e.preventDefault();
  const btn=document.getElementById('subBtn'),pg=document.getElementById('prog'),pb=document.getElementById('progBar');
  const prevErr=document.getElementById('formErrBox');if(prevErr)prevErr.remove();
  btn.disabled=true;btn.innerHTML='<span>â³</span> <span>××¢×œ×”...</span>';
  if(imgFiles.length)pg.style.display='block';
  try{
    const urls=[];
    if(imgFiles.length>0){
      for(let i=0;i<imgFiles.length;i++){
        btn.innerHTML=`<span>ğŸ“·</span> <span>××¢×œ×” ×ª××•× ×” ${i+1}/${imgFiles.length}...</span>`;
        pb.style.width=`${Math.round(((i+1)/imgFiles.length)*100)}%`;
        try{urls.push(await uploadImg(imgFiles[i]))}catch(imgErr){if(i===0)throw imgErr;console.warn('[YOUGO] Image',i,'failed:',imgErr.message)}
      }
    }
    pg.style.display='none';

    const make=document.getElementById('f_make').value.trim();
    const model=document.getElementById('f_model').value.trim();
    const year=parseInt(document.getElementById('f_year').value);
    const price=parseInt(document.getElementById('f_price').value);
    const sellerName=document.getElementById('f_name').value.trim();
    const sellerPhone=document.getElementById('f_phone').value.trim();
    const sellerCity=document.getElementById('f_city').value.trim();
    if(!make||!model||!year||!price||!sellerName||!sellerPhone||!sellerCity){
      throw new Error('×× × ××œ× ××ª ×›×œ ×©×“×•×ª ×”×—×•×‘×” (*)');
    }

    btn.innerHTML='<span>ğŸ’¾</span> <span>×©×•××¨...</span>';

    const payload={
      make,model,year,price,
      mileage:parseInt(document.getElementById('f_mileage').value)||0,
      hand:parseInt(document.getElementById('f_hand').value)||2,
      gear_type:document.getElementById('f_gear').value,
      fuel_type:document.getElementById('f_fuel').value,
      color:document.getElementById('f_color').value.trim()||null,
      engine_size:parseFloat(document.getElementById('f_engine').value)||null,
      description_he:document.getElementById('f_desc_he').value||null,
      description_ar:document.getElementById('f_desc_ar').value||null,
      seller_name:sellerName,
      seller_phone:sellerPhone,
      seller_city:sellerCity,
      images:urls,
      main_image:urls[0]||null,
      status:'active'
    };

    console.log('[YOUGO] Inserting:', payload);
    const{data,error}=await sb.from(TABLE).insert(payload).select();
    console.log('[YOUGO] Insert result:', {data,error});

    if(error)throw new Error(getErrMsg(error));

    await loadCars();
    document.getElementById('addBody').innerHTML=`
      <div style="text-align:center;padding:48px 20px">
        <div style="font-size:60px;margin-bottom:18px">ğŸ‰</div>
        <h3 style="font-size:1.5rem;font-weight:900;margin-bottom:10px;color:#fff">×”××•×“×¢×” ×¤×•×¨×¡××”!</h3>
        <p style="color:rgba(255,255,255,.7);font-size:14px;margin-bottom:24px">×”×¨×›×‘ ×©×œ×š ×–××™×Ÿ ×¢×›×©×™×• ×œ×›×•×œ× ğŸš—âœ¨</p>
        <button class="btn btn-red" style="padding:14px 36px;font-size:15px" onclick="closeAdd();document.getElementById('addBody').innerHTML=''">×¡×’×•×¨</button>
      </div>`;
    showToast('ğŸš— ×”××•×“×¢×” ×¤×•×¨×¡××” ×‘×”×¦×œ×—×”!','ok');

  }catch(err){
    const msg=getErrMsg(err);
    console.error('[YOUGO] Submit error:',err);
    showErrInForm(msg);
    showToast('âŒ '+msg.slice(0,60),'err');
    btn.disabled=false;
    btn.innerHTML='<span class="sub-icon">ğŸš—</span><span id="subBtnTxt">×¤×¨×¡× ××•×“×¢×” ×‘×—×™× × â€” ××™×™×“×™!</span>';
    pg.style.display='none';
    pb.style.width='0%';
  }
}

// â”€â”€ ADMIN â”€â”€
function adminLogin(){
  const p=prompt('ğŸ”‘ Admin Password:');if(p===null)return;
  if(p===ADMIN_PW){
    isAdmin=true;
    document.getElementById('adminBar').classList.add('show');
    document.getElementById('adminActs').innerHTML=`
      <span style="color:var(--t1);font-size:12.5px;font-weight:600">Admin Mode</span>
      <button onclick="loadCars()" style="background:rgba(200,16,46,.12);border:1px solid var(--bred);color:var(--red);padding:6px 14px;border-radius:8px;cursor:pointer;font-size:12px;font-weight:900;font-family:var(--font)">ğŸ”„ ×¨×¢× ×Ÿ</button>
      <a href="admin.html" style="background:rgba(59,130,246,.12);border:1px solid rgba(59,130,246,.3);color:#60a5fa;padding:6px 14px;border-radius:8px;font-size:12px;font-weight:900;font-family:var(--font);text-decoration:none">âš™ï¸ ×œ×•×— × ×™×”×•×œ</a>
      <button onclick="adminOut()" style="background:var(--bg3);border:1px solid var(--b0);color:var(--t1);padding:6px 14px;border-radius:8px;cursor:pointer;font-size:12px;font-family:var(--font)">×™×¦×™××”</button>`;
    loadCars();showToast('âœ… Admin Mode','ok');
  }else showToast('âŒ ×¡×™×¡××” ×©×’×•×™×”','err');
}
function adminOut(){isAdmin=false;document.getElementById('adminBar').classList.remove('show');loadCars()}
async function approve(id){const{error}=await sb.from(TABLE).update({status:'active'}).eq('id',id);if(!error){showToast('âœ… ××•×©×¨×”','ok');loadCars()}else showToast('âŒ '+error.message,'err')}
async function markSold(id){const{error}=await sb.from(TABLE).update({status:'sold'}).eq('id',id);if(!error){showToast('âœ… × ××›×¨','ok');loadCars()}}
async function delCar(id){if(!confirm('×œ××—×•×§ ×œ×¦××™×ª×•×ª?'))return;const{error}=await sb.from(TABLE).delete().eq('id',id);if(!error){showToast('ğŸ—‘ï¸ × ××—×§×”','ok');loadCars()}else showToast('âŒ '+error.message,'err')}

function showToast(msg,type='ok'){const el=document.getElementById('toast');el.textContent=msg;el.className=`show ${type}`;clearTimeout(el._t);el._t=setTimeout(()=>el.className='',3400)}
function showHome(){filtered=[...all];doSort(sort);window.scrollTo({top:0,behavior:'smooth'})}

document.addEventListener('keydown',e=>{if(e.key==='Escape'){closeDetail();closeAdd()}});

// â”€â”€ INIT â”€â”€
loadCars();
</script>
</body>
</html>
